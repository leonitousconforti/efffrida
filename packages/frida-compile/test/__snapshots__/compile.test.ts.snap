// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`Should compile the agent > conflicting exports agent 1`] = `"var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(t,e)=>function(){return e||(0,t[__getOwnPropNames(t)[0]])((e={exports:{}}).exports,e),e.exports},__copyProps=(t,e,o,s)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of __getOwnPropNames(e))__hasOwnProp.call(t,r)||r===o||__defProp(t,r,{get:()=>e[r],enumerable:!(s=__getOwnPropDesc(e,r))||s.enumerable});return t},__toESM=(t,e,o)=>(o=null!=t?__create(__getProtoOf(t)):{},__copyProps(!e&&t&&t.__esModule?o:__defProp(o,"default",{value:t,enumerable:!0}),t)),require_text_min=__commonJS({"node_modules/.pnpm/fast-text-encoding@1.0.6/node_modules/fast-text-encoding/text.min.js"(t){"use strict";!function(t){function e(t){for(var e=0,o=Math.min(65536,t.length+1),s=new Uint16Array(o),r=[],n=0;;){var a=e<t.length;if(!a||n>=o-1){var i=s.subarray(0,n);if(r.push(String.fromCharCode.apply(null,i)),!a)return r.join("");t=t.subarray(e),e=0,n=0}var h=t[e++];if(0==(128&h))s[n++]=h;else if(192==(224&h)){var c=63&t[e++];s[n++]=(31&h)<<6|c}else if(224==(240&h)){c=63&t[e++];var l=63&t[e++];s[n++]=(31&h)<<12|c<<6|l}else if(240==(248&h)){var u=(7&h)<<18|(c=63&t[e++])<<12|(l=63&t[e++])<<6|63&t[e++];u>65535&&(u-=65536,s[n++]=u>>>10&1023|55296,u=56320|1023&u),s[n++]=u}}}var o="Failed to ",s=function(t,e,s){if(t)throw new Error("".concat(o).concat(e,": the '").concat(s,"' option is unsupported."))},r="function"==typeof Buffer&&Buffer.from,n=r?function(t){return Buffer.from(t)}:function(t){for(var e=0,o=t.length,s=0,r=Math.max(32,o+(o>>>1)+7),n=new Uint8Array(r>>>3<<3);e<o;){var a=t.charCodeAt(e++);if(a>=55296&&a<=56319){if(e<o){var i=t.charCodeAt(e);56320==(64512&i)&&(++e,a=((1023&a)<<10)+(1023&i)+65536)}if(a>=55296&&a<=56319)continue}if(s+4>n.length){r+=8,r=(r*=1+e/t.length*2)>>>3<<3;var h=new Uint8Array(r);h.set(n),n=h}if(0!=(4294967168&a)){if(0==(4294965248&a))n[s++]=a>>>6&31|192;else if(0==(4294901760&a))n[s++]=a>>>12&15|224,n[s++]=a>>>6&63|128;else{if(0!=(4292870144&a))continue;n[s++]=a>>>18&7|240,n[s++]=a>>>12&63|128,n[s++]=a>>>6&63|128}n[s++]=63&a|128}else n[s++]=a}return n.slice?n.slice(0,s):n.subarray(0,s)};function a(){this.encoding="utf-8"}a.prototype.encode=function(t,e){return s(e&&e.stream,"encode","stream"),n(t)};var i=!r&&"function"==typeof Blob&&"function"==typeof Url&&"function"==typeof Url.createObjectURL,h=["utf-8","utf8","unicode-1-1-utf-8"],c=e;r?c=function(t,e){return(t instanceof Buffer?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength)).toString(e)}:i&&(c=function(t){try{return function(t){var e;try{var o=new Blob([t],{type:"text/plain;charset=UTF-8"});e=Url.createObjectURL(o);var s=new XMLHttpRequest;return s.open("GET",e,!1),s.send(),s.responseText}finally{e&&Url.revokeObjectURL(e)}}(t)}catch(o){return e(t)}});var l="construct 'TextDecoder'",u="".concat(o," ").concat(l,": the ");function f(t,e){if(s(e&&e.fatal,l,"fatal"),t=t||"utf-8",!(r?Buffer.isEncoding(t):-1!==h.indexOf(t.toLowerCase())))throw new RangeError("".concat(u," encoding label provided ('").concat(t,"') is invalid."));this.encoding=t,this.fatal=!1,this.ignoreBOM=!1}f.prototype.decode=function(t,e){var o;return s(e&&e.stream,"decode","stream"),o=t instanceof Uint8Array?t:t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer):new Uint8Array(t),c(o,this.encoding)},t.TextEncoder=t.TextEncoder||a,t.TextDecoder=t.TextDecoder||f}("undefined"!=typeof window?window:"undefined"!=typeof global?global:t)}}),fridaSetImmediate=globalThis.setImmediate,fridaClearImmediate=globalThis.clearImmediate,import_text_min3=__toESM(require_text_min(),1),import_text_min=__toESM(require_text_min(),1),maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\\0-\\x7E]/,regexSeparators=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(t){throw new RangeError(errors[t])}function map(t,e){const o=[];let s=t.length;for(;s--;)o[s]=e(t[s]);return o}function mapDomain(t,e){const o=t.split("@");let s="";o.length>1&&(s=o[0]+"@",t=o[1]);return s+map((t=t.replace(regexSeparators,".")).split("."),e).join(".")}function ucs2decode(t){const e=[];let o=0;const s=t.length;for(;o<s;){const r=t.charCodeAt(o++);if(r>=55296&&r<=56319&&o<s){const s=t.charCodeAt(o++);56320==(64512&s)?e.push(((1023&r)<<10)+(1023&s)+65536):(e.push(r),o--)}else e.push(r)}return e}var digitToBasic=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},adapt=function(t,e,o){let s=0;for(t=o?floor(t/damp):t>>1,t+=floor(t/e);t>baseMinusTMin*tMax>>1;s+=base)t=floor(t/baseMinusTMin);return floor(s+(baseMinusTMin+1)*t/(t+skew))};function encode(t){const e=[];let o=(t=ucs2decode(t)).length,s=initialN,r=0,n=initialBias;for(const o of t)o<128&&e.push(stringFromCharCode(o));let a=e.length,i=a;for(a&&e.push(delimiter);i<o;){let o=maxInt;for(const e of t)e>=s&&e<o&&(o=e);const h=i+1;o-s>floor((maxInt-r)/h)&&error("overflow"),r+=(o-s)*h,s=o;for(const o of t)if(o<s&&++r>maxInt&&error("overflow"),o==s){let t=r;for(let o=base;;o+=base){const s=o<=n?tMin:o>=n+tMax?tMax:o-n;if(t<s)break;const r=t-s,a=base-s;e.push(stringFromCharCode(digitToBasic(s+r%a,0))),t=floor(r/a)}e.push(stringFromCharCode(digitToBasic(t,0))),n=adapt(r,h,i==a),r=0,++i}++r,++s}return e.join("")}function toASCII(t){return mapDomain(t,(function(t){return regexNonASCII.test(t)?"xn--"+encode(t):t}))}var import_text_min2=__toESM(require_text_min(),1);function stringify(t,e,o,s){return e=e||"&",o=o||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((s=>{const r=encodeURIComponent(stringifyPrimitive(s))+o;return Array.isArray(t[s])?t[s].map((function(t){return r+encodeURIComponent(stringifyPrimitive(t))})).join(e):r+encodeURIComponent(stringifyPrimitive(t[s]))})).filter(Boolean).join(e):s?encodeURIComponent(stringifyPrimitive(s))+o+encodeURIComponent(stringifyPrimitive(t)):""}function stringifyPrimitive(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function parse(t,e,o,s){e=e||"&",o=o||"=";const r={};if("string"!=typeof t||0===t.length)return r;const n=/\\+/g;t=t.split(e);let a=1e3;s&&"number"==typeof s.maxKeys&&(a=s.maxKeys);let i=t.length;a>0&&i>a&&(i=a);for(let e=0;e<i;e++){const s=t[e].replace(n,"%20");let a,i;const h=s.indexOf(o);h>=0?(a=s.substr(0,h),i=s.substr(h+1)):(a=s,i="");const c=decodeURIComponent(a),l=decodeURIComponent(i);Object.prototype.hasOwnProperty.call(r,c)?Array.isArray(r[c])?r[c].push(l):r[c]=[r[c],l]:r[c]=l}return r}var querystring_default={stringify:stringify,encode:stringify,parse:parse,decode:parse};function Url2(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^[a-z0-9.+-]+:/i,portPattern=/:[0-9]*$/,hostPattern=/^\\/\\/[^@/]+@[^@/]+/,simplePathPattern=/^(\\/\\/?(?!\\/)[^?\\s]*)(\\?[^\\s]*)?$/,hostnameMaxLen=255,unsafeProtocol=new Set(["javascript","javascript:"]),hostlessProtocol=new Set(["javascript","javascript:"]),slashedProtocol=new Set(["http","http:","https","https:","ftp","ftp:","gopher","gopher:","file","file:","ws","ws:","wss","wss:"]),CHAR_SPACE=32,CHAR_TAB=9,CHAR_CARRIAGE_RETURN=13,CHAR_LINE_FEED=10,CHAR_FORM_FEED=12,CHAR_NO_BREAK_SPACE=160,CHAR_ZERO_WIDTH_NOBREAK_SPACE=65279,CHAR_HASH=35,CHAR_FORWARD_SLASH=47,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_LEFT_ANGLE_BRACKET=60,CHAR_RIGHT_ANGLE_BRACKET=62,CHAR_LEFT_CURLY_BRACKET=123,CHAR_RIGHT_CURLY_BRACKET=125,CHAR_QUESTION_MARK=63,CHAR_LOWERCASE_A=97,CHAR_LOWERCASE_Z=122,CHAR_UPPERCASE_A=65,CHAR_UPPERCASE_Z=90,CHAR_DOT=46,CHAR_0=48,CHAR_9=57,CHAR_HYPHEN_MINUS=45,CHAR_PLUS=43,CHAR_UNDERSCORE=95,CHAR_DOUBLE_QUOTE=34,CHAR_SINGLE_QUOTE=39,CHAR_PERCENT=37,CHAR_SEMICOLON=59,CHAR_BACKWARD_SLASH=92,CHAR_CIRCUMFLEX_ACCENT=94,CHAR_GRAVE_ACCENT=96,CHAR_VERTICAL_LINE=124,CHAR_AT=64;function urlParse(t,e,o){if(t instanceof Url2)return t;const s=new Url2;return s.parse(t,e,o),s}function isIpv6Hostname(t){return t.charCodeAt(0)===CHAR_LEFT_SQUARE_BRACKET&&t.charCodeAt(t.length-1)===CHAR_RIGHT_SQUARE_BRACKET}var forbiddenHostChars=/[\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;function getHostname(t,e,o){for(let s=0;s<o.length;++s){const r=o.charCodeAt(s);if(!(r>=CHAR_LOWERCASE_A&&r<=CHAR_LOWERCASE_Z||r===CHAR_DOT||r>=CHAR_UPPERCASE_A&&r<=CHAR_UPPERCASE_Z||r>=CHAR_0&&r<=CHAR_9||r===CHAR_HYPHEN_MINUS||r===CHAR_PLUS||r===CHAR_UNDERSCORE||r>127))return t.hostname=o.slice(0,s),\`/\${o.slice(s)}\${e}\`}return e}Url2.prototype.parse=function(t,e,o){let s=!1,r=-1,n=-1,a="",i=0;for(let e=0,o=!1,h=!1;e<t.length;++e){const c=t.charCodeAt(e),l=c===CHAR_SPACE||c===CHAR_TAB||c===CHAR_CARRIAGE_RETURN||c===CHAR_LINE_FEED||c===CHAR_FORM_FEED||c===CHAR_NO_BREAK_SPACE||c===CHAR_ZERO_WIDTH_NOBREAK_SPACE;if(-1===r){if(l)continue;i=r=e}else o?l||(n=-1,o=!1):l&&(n=e,o=!0);if(h)s||c!==CHAR_HASH||(s=!0);else switch(c){case CHAR_HASH:s=!0;case CHAR_QUESTION_MARK:h=!0;break;case CHAR_BACKWARD_SLASH:e-i>0&&(a+=t.slice(i,e)),a+="/",i=e+1}}if(-1!==r&&(i===r?a=-1===n?0===r?t:t.slice(r):t.slice(r,n):-1===n&&i<t.length?a+=t.slice(i):-1!==n&&i<n&&(a+=t.slice(i,n))),!o&&!s){const t=simplePathPattern.exec(a);if(t)return this.path=a,this.href=a,this.pathname=t[1],t[2]?(this.search=t[2],this.query=e?querystring_default.parse(this.search.slice(1)):this.search.slice(1)):e&&(this.search=null,this.query=Object.create(null)),this}let h,c,l=protocolPattern.exec(a);if(l&&(l=l[0],h=l.toLowerCase(),this.protocol=h,a=a.slice(l.length)),(o||l||hostPattern.test(a))&&(c=a.charCodeAt(0)===CHAR_FORWARD_SLASH&&a.charCodeAt(1)===CHAR_FORWARD_SLASH,!c||l&&hostlessProtocol.has(h)||(a=a.slice(2),this.slashes=!0)),!hostlessProtocol.has(h)&&(c||l&&!slashedProtocol.has(l))){let t=-1,e=-1,o=-1;for(let s=0;s<a.length;++s){switch(a.charCodeAt(s)){case CHAR_TAB:case CHAR_LINE_FEED:case CHAR_CARRIAGE_RETURN:case CHAR_SPACE:case CHAR_DOUBLE_QUOTE:case CHAR_PERCENT:case CHAR_SINGLE_QUOTE:case CHAR_SEMICOLON:case CHAR_LEFT_ANGLE_BRACKET:case CHAR_RIGHT_ANGLE_BRACKET:case CHAR_BACKWARD_SLASH:case CHAR_CIRCUMFLEX_ACCENT:case CHAR_GRAVE_ACCENT:case CHAR_LEFT_CURLY_BRACKET:case CHAR_VERTICAL_LINE:case CHAR_RIGHT_CURLY_BRACKET:-1===o&&(o=s);break;case CHAR_HASH:case CHAR_FORWARD_SLASH:case CHAR_QUESTION_MARK:-1===o&&(o=s),t=s;break;case CHAR_AT:e=s,o=-1}if(-1!==t)break}r=0,-1!==e&&(this.auth=decodeURIComponent(a.slice(0,e)),r=e+1),-1===o?(this.host=a.slice(r),a=""):(this.host=a.slice(r,o),a=a.slice(o)),this.parseHost(),"string"!=typeof this.hostname&&(this.hostname="");const s=this.hostname,n=isIpv6Hostname(s);if(n||(a=getHostname(this,a,s)),this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!n&&""!==this.hostname&&(this.hostname=toASCII(this.hostname,!0),""===this.hostname||forbiddenHostChars.test(this.hostname)))throw new Error("invalid URL");const i=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+i,n&&(this.hostname=this.hostname.slice(1,-1),"/"!==a[0]&&(a="/"+a))}unsafeProtocol.has(h)||(a=autoEscapeStr(a));let u=-1,f=-1;for(let t=0;t<a.length;++t){const e=a.charCodeAt(t);if(e===CHAR_HASH){this.hash=a.slice(t),f=t;break}e===CHAR_QUESTION_MARK&&-1===u&&(u=t)}-1!==u?(-1===f?(this.search=a.slice(u),this.query=a.slice(u+1)):(this.search=a.slice(u,f),this.query=a.slice(u+1,f)),e&&(this.query=querystring_default.parse(this.query))):e&&(this.search=null,this.query=Object.create(null));const p=-1!==u&&(-1===f||u<f)?u:f;if(-1===p?a.length>0&&(this.pathname=a):p>0&&(this.pathname=a.slice(0,p)),slashedProtocol.has(h)&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){const t=this.pathname||"",e=this.search||"";this.path=t+e}return this.href=this.format(),this};var escapedCodes=["","","","","","","","","","%09","%0A","","","%0D","","","","","","","","","","","","","","","","","","","%20","","%22","","","","","%27","","","","","","","","","","","","","","","","","","","","","%3C","","%3E","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","%5C","","%5E","","%60","","","","","","","","","","","","","","","","","","","","","","","","","","","%7B","%7C","%7D"];function autoEscapeStr(t){let e="",o=0;for(let s=0;s<t.length;++s){const r=escapedCodes[t.charCodeAt(s)];r&&(s>o&&(e+=t.slice(o,s)),e+=r,o=s+1)}return 0===o?t:(o<t.length&&(e+=t.slice(o)),e)}var cachedSetTimeout,cachedClearTimeout,noEscapeAuth=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);function spliceOne(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function defaultSetTimeout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function Item(t,e){this.fun=t,this.array=e}Url2.prototype.format=function(){let t=this.auth||"";t&&(t=encodeStr(t,noEscapeAuth,hexTable),t+="@");let e=this.protocol||"",o=this.pathname||"",s=this.hash||"",r="",n="";this.host?r=t+this.host:this.hostname&&(r=t+(this.hostname.includes(":")&&!isIpv6Hostname(this.hostname)?"["+this.hostname+"]":this.hostname),this.port&&(r+=":"+this.port)),null!==this.query&&"object"==typeof this.query&&(n=querystring_default.stringify(this.query));let a=this.search||n&&"?"+n||"";e&&58!==e.charCodeAt(e.length-1)&&(e+=":");let i="",h=0;for(let t=0;t<o.length;++t)switch(o.charCodeAt(t)){case CHAR_HASH:t-h>0&&(i+=o.slice(h,t)),i+="%23",h=t+1;break;case CHAR_QUESTION_MARK:t-h>0&&(i+=o.slice(h,t)),i+="%3F",h=t+1}return h>0&&(o=h!==o.length?i+o.slice(h):i),(this.slashes||slashedProtocol.has(e))&&(this.slashes||r?(o&&o.charCodeAt(0)!==CHAR_FORWARD_SLASH&&(o="/"+o),r="//"+r):e.length>=4&&102===e.charCodeAt(0)&&105===e.charCodeAt(1)&&108===e.charCodeAt(2)&&101===e.charCodeAt(3)&&(r="//")),a=a.replace(/#/g,"%23"),s&&s.charCodeAt(0)!==CHAR_HASH&&(s="#"+s),a&&a.charCodeAt(0)!==CHAR_QUESTION_MARK&&(a="?"+a),e+r+o+a+s},Url2.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url2.prototype.resolveObject=function(t){if("string"==typeof t){const e=new Url2;e.parse(t,!1,!0),t=e}const e=new Url2,o=Object.keys(this);for(let t=0;t<o.length;t++){const s=o[t];e[s]=this[s]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){const o=Object.keys(t);for(let s=0;s<o.length;s++){const r=o[s];"protocol"!==r&&(e[r]=t[r])}return slashedProtocol.has(e.protocol)&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol.has(t.protocol)){const o=Object.keys(t);for(let s=0;s<o.length;s++){const r=o[s];e[r]=t[r]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||/^file:?$/.test(t.protocol)||hostlessProtocol.has(t.protocol))e.pathname=t.pathname;else{const o=(t.pathname||"").split("/");for(;o.length&&!(t.host=o.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),e.pathname=o.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){const t=e.pathname||"",o=e.search||"";e.path=t+o}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}const s=e.pathname&&"/"===e.pathname.charAt(0),r=t.host||t.pathname&&"/"===t.pathname.charAt(0);let n=r||s||e.host&&t.pathname;const a=n;let i=e.pathname&&e.pathname.split("/")||[];const h=t.pathname&&t.pathname.split("/")||[],c=e.protocol&&!slashedProtocol.has(e.protocol);if(c&&(e.hostname="",e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,e.auth=null,t.host&&(""===h[0]?h[0]=t.host:h.unshift(t.host)),t.host=null),n=n&&(""===h[0]||""===i[0])),r)(t.host||""===t.host)&&(e.host!==t.host&&(e.auth=null),e.host=t.host,e.port=t.port),(t.hostname||""===t.hostname)&&(e.hostname!==t.hostname&&(e.auth=null),e.hostname=t.hostname),e.search=t.search,e.query=t.query,i=h;else if(h.length)i||(i=[]),i.pop(),i=i.concat(h),e.search=t.search,e.query=t.query;else if(null!==t.search&&void 0!==t.search){if(c){e.hostname=e.host=i.shift();const t=e.host&&e.host.indexOf("@")>0&&e.host.split("@");t&&(e.auth=t.shift(),e.host=e.hostname=t.shift())}return e.search=t.search,e.query=t.query,null===e.pathname&&null===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!i.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;let l=i.slice(-1)[0];const u=(e.host||t.host||i.length>1)&&("."===l||".."===l)||""===l;let f=0;for(let t=i.length-1;t>=0;t--)l=i[t],"."===l?spliceOne(i,t):".."===l?(spliceOne(i,t),f++):f&&(spliceOne(i,t),f--);if(!n&&!a)for(;f--;)i.unshift("..");!n||""===i[0]||i[0]&&"/"===i[0].charAt(0)||i.unshift(""),u&&"/"!==i.join("/").substr(-1)&&i.push("");const p=""===i[0]||i[0]&&"/"===i[0].charAt(0);if(c){e.hostname=e.host=p?"":i.length?i.shift():"";const t=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");t&&(e.auth=t.shift(),e.host=e.hostname=t.shift())}return n=n||e.host&&i.length,n&&!p&&i.unshift(""),i.length?e.pathname=i.join("/"):(e.pathname=null,e.path=null),null===e.pathname&&null===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url2.prototype.parseHost=function(){let t=this.host,e=portPattern.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.slice(1)),t=t.slice(0,t.length-e.length)),t&&(this.hostname=t)},function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimeout}catch(t){cachedSetTimeout=defaultSetTimeout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){cachedClearTimeout=defaultClearTimeout}}(),Item.prototype.run=function(){this.fun.apply(null,this.array)};var import_text_min6=__toESM(require_text_min(),1),import_text_min4=__toESM(require_text_min(),1),A="another->A",B="another->B",import_text_min5=__toESM(require_text_min(),1),A2="other->A";console.log("Hello from agent3",A2,A,B);"`;

exports[`Should compile the agent > double file agent 1`] = `"var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(t,e)=>function(){return e||(0,t[__getOwnPropNames(t)[0]])((e={exports:{}}).exports,e),e.exports},__copyProps=(t,e,o,s)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of __getOwnPropNames(e))__hasOwnProp.call(t,r)||r===o||__defProp(t,r,{get:()=>e[r],enumerable:!(s=__getOwnPropDesc(e,r))||s.enumerable});return t},__toESM=(t,e,o)=>(o=null!=t?__create(__getProtoOf(t)):{},__copyProps(!e&&t&&t.__esModule?o:__defProp(o,"default",{value:t,enumerable:!0}),t)),require_text_min=__commonJS({"node_modules/.pnpm/fast-text-encoding@1.0.6/node_modules/fast-text-encoding/text.min.js"(t){"use strict";!function(t){function e(t){for(var e=0,o=Math.min(65536,t.length+1),s=new Uint16Array(o),r=[],n=0;;){var a=e<t.length;if(!a||n>=o-1){var i=s.subarray(0,n);if(r.push(String.fromCharCode.apply(null,i)),!a)return r.join("");t=t.subarray(e),e=0,n=0}var h=t[e++];if(0==(128&h))s[n++]=h;else if(192==(224&h)){var c=63&t[e++];s[n++]=(31&h)<<6|c}else if(224==(240&h)){c=63&t[e++];var l=63&t[e++];s[n++]=(31&h)<<12|c<<6|l}else if(240==(248&h)){var u=(7&h)<<18|(c=63&t[e++])<<12|(l=63&t[e++])<<6|63&t[e++];u>65535&&(u-=65536,s[n++]=u>>>10&1023|55296,u=56320|1023&u),s[n++]=u}}}var o="Failed to ",s=function(t,e,s){if(t)throw new Error("".concat(o).concat(e,": the '").concat(s,"' option is unsupported."))},r="function"==typeof Buffer&&Buffer.from,n=r?function(t){return Buffer.from(t)}:function(t){for(var e=0,o=t.length,s=0,r=Math.max(32,o+(o>>>1)+7),n=new Uint8Array(r>>>3<<3);e<o;){var a=t.charCodeAt(e++);if(a>=55296&&a<=56319){if(e<o){var i=t.charCodeAt(e);56320==(64512&i)&&(++e,a=((1023&a)<<10)+(1023&i)+65536)}if(a>=55296&&a<=56319)continue}if(s+4>n.length){r+=8,r=(r*=1+e/t.length*2)>>>3<<3;var h=new Uint8Array(r);h.set(n),n=h}if(0!=(4294967168&a)){if(0==(4294965248&a))n[s++]=a>>>6&31|192;else if(0==(4294901760&a))n[s++]=a>>>12&15|224,n[s++]=a>>>6&63|128;else{if(0!=(4292870144&a))continue;n[s++]=a>>>18&7|240,n[s++]=a>>>12&63|128,n[s++]=a>>>6&63|128}n[s++]=63&a|128}else n[s++]=a}return n.slice?n.slice(0,s):n.subarray(0,s)};function a(){this.encoding="utf-8"}a.prototype.encode=function(t,e){return s(e&&e.stream,"encode","stream"),n(t)};var i=!r&&"function"==typeof Blob&&"function"==typeof Url&&"function"==typeof Url.createObjectURL,h=["utf-8","utf8","unicode-1-1-utf-8"],c=e;r?c=function(t,e){return(t instanceof Buffer?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength)).toString(e)}:i&&(c=function(t){try{return function(t){var e;try{var o=new Blob([t],{type:"text/plain;charset=UTF-8"});e=Url.createObjectURL(o);var s=new XMLHttpRequest;return s.open("GET",e,!1),s.send(),s.responseText}finally{e&&Url.revokeObjectURL(e)}}(t)}catch(o){return e(t)}});var l="construct 'TextDecoder'",u="".concat(o," ").concat(l,": the ");function f(t,e){if(s(e&&e.fatal,l,"fatal"),t=t||"utf-8",!(r?Buffer.isEncoding(t):-1!==h.indexOf(t.toLowerCase())))throw new RangeError("".concat(u," encoding label provided ('").concat(t,"') is invalid."));this.encoding=t,this.fatal=!1,this.ignoreBOM=!1}f.prototype.decode=function(t,e){var o;return s(e&&e.stream,"decode","stream"),o=t instanceof Uint8Array?t:t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer):new Uint8Array(t),c(o,this.encoding)},t.TextEncoder=t.TextEncoder||a,t.TextDecoder=t.TextDecoder||f}("undefined"!=typeof window?window:"undefined"!=typeof global?global:t)}}),fridaSetImmediate=globalThis.setImmediate,fridaClearImmediate=globalThis.clearImmediate,import_text_min3=__toESM(require_text_min(),1),import_text_min=__toESM(require_text_min(),1),maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\\0-\\x7E]/,regexSeparators=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(t){throw new RangeError(errors[t])}function map(t,e){const o=[];let s=t.length;for(;s--;)o[s]=e(t[s]);return o}function mapDomain(t,e){const o=t.split("@");let s="";o.length>1&&(s=o[0]+"@",t=o[1]);return s+map((t=t.replace(regexSeparators,".")).split("."),e).join(".")}function ucs2decode(t){const e=[];let o=0;const s=t.length;for(;o<s;){const r=t.charCodeAt(o++);if(r>=55296&&r<=56319&&o<s){const s=t.charCodeAt(o++);56320==(64512&s)?e.push(((1023&r)<<10)+(1023&s)+65536):(e.push(r),o--)}else e.push(r)}return e}var digitToBasic=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},adapt=function(t,e,o){let s=0;for(t=o?floor(t/damp):t>>1,t+=floor(t/e);t>baseMinusTMin*tMax>>1;s+=base)t=floor(t/baseMinusTMin);return floor(s+(baseMinusTMin+1)*t/(t+skew))};function encode(t){const e=[];let o=(t=ucs2decode(t)).length,s=initialN,r=0,n=initialBias;for(const o of t)o<128&&e.push(stringFromCharCode(o));let a=e.length,i=a;for(a&&e.push(delimiter);i<o;){let o=maxInt;for(const e of t)e>=s&&e<o&&(o=e);const h=i+1;o-s>floor((maxInt-r)/h)&&error("overflow"),r+=(o-s)*h,s=o;for(const o of t)if(o<s&&++r>maxInt&&error("overflow"),o==s){let t=r;for(let o=base;;o+=base){const s=o<=n?tMin:o>=n+tMax?tMax:o-n;if(t<s)break;const r=t-s,a=base-s;e.push(stringFromCharCode(digitToBasic(s+r%a,0))),t=floor(r/a)}e.push(stringFromCharCode(digitToBasic(t,0))),n=adapt(r,h,i==a),r=0,++i}++r,++s}return e.join("")}function toASCII(t){return mapDomain(t,(function(t){return regexNonASCII.test(t)?"xn--"+encode(t):t}))}var import_text_min2=__toESM(require_text_min(),1);function stringify(t,e,o,s){return e=e||"&",o=o||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((s=>{const r=encodeURIComponent(stringifyPrimitive(s))+o;return Array.isArray(t[s])?t[s].map((function(t){return r+encodeURIComponent(stringifyPrimitive(t))})).join(e):r+encodeURIComponent(stringifyPrimitive(t[s]))})).filter(Boolean).join(e):s?encodeURIComponent(stringifyPrimitive(s))+o+encodeURIComponent(stringifyPrimitive(t)):""}function stringifyPrimitive(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function parse(t,e,o,s){e=e||"&",o=o||"=";const r={};if("string"!=typeof t||0===t.length)return r;const n=/\\+/g;t=t.split(e);let a=1e3;s&&"number"==typeof s.maxKeys&&(a=s.maxKeys);let i=t.length;a>0&&i>a&&(i=a);for(let e=0;e<i;e++){const s=t[e].replace(n,"%20");let a,i;const h=s.indexOf(o);h>=0?(a=s.substr(0,h),i=s.substr(h+1)):(a=s,i="");const c=decodeURIComponent(a),l=decodeURIComponent(i);Object.prototype.hasOwnProperty.call(r,c)?Array.isArray(r[c])?r[c].push(l):r[c]=[r[c],l]:r[c]=l}return r}var querystring_default={stringify:stringify,encode:stringify,parse:parse,decode:parse};function Url2(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^[a-z0-9.+-]+:/i,portPattern=/:[0-9]*$/,hostPattern=/^\\/\\/[^@/]+@[^@/]+/,simplePathPattern=/^(\\/\\/?(?!\\/)[^?\\s]*)(\\?[^\\s]*)?$/,hostnameMaxLen=255,unsafeProtocol=new Set(["javascript","javascript:"]),hostlessProtocol=new Set(["javascript","javascript:"]),slashedProtocol=new Set(["http","http:","https","https:","ftp","ftp:","gopher","gopher:","file","file:","ws","ws:","wss","wss:"]),CHAR_SPACE=32,CHAR_TAB=9,CHAR_CARRIAGE_RETURN=13,CHAR_LINE_FEED=10,CHAR_FORM_FEED=12,CHAR_NO_BREAK_SPACE=160,CHAR_ZERO_WIDTH_NOBREAK_SPACE=65279,CHAR_HASH=35,CHAR_FORWARD_SLASH=47,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_LEFT_ANGLE_BRACKET=60,CHAR_RIGHT_ANGLE_BRACKET=62,CHAR_LEFT_CURLY_BRACKET=123,CHAR_RIGHT_CURLY_BRACKET=125,CHAR_QUESTION_MARK=63,CHAR_LOWERCASE_A=97,CHAR_LOWERCASE_Z=122,CHAR_UPPERCASE_A=65,CHAR_UPPERCASE_Z=90,CHAR_DOT=46,CHAR_0=48,CHAR_9=57,CHAR_HYPHEN_MINUS=45,CHAR_PLUS=43,CHAR_UNDERSCORE=95,CHAR_DOUBLE_QUOTE=34,CHAR_SINGLE_QUOTE=39,CHAR_PERCENT=37,CHAR_SEMICOLON=59,CHAR_BACKWARD_SLASH=92,CHAR_CIRCUMFLEX_ACCENT=94,CHAR_GRAVE_ACCENT=96,CHAR_VERTICAL_LINE=124,CHAR_AT=64;function urlParse(t,e,o){if(t instanceof Url2)return t;const s=new Url2;return s.parse(t,e,o),s}function isIpv6Hostname(t){return t.charCodeAt(0)===CHAR_LEFT_SQUARE_BRACKET&&t.charCodeAt(t.length-1)===CHAR_RIGHT_SQUARE_BRACKET}var forbiddenHostChars=/[\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;function getHostname(t,e,o){for(let s=0;s<o.length;++s){const r=o.charCodeAt(s);if(!(r>=CHAR_LOWERCASE_A&&r<=CHAR_LOWERCASE_Z||r===CHAR_DOT||r>=CHAR_UPPERCASE_A&&r<=CHAR_UPPERCASE_Z||r>=CHAR_0&&r<=CHAR_9||r===CHAR_HYPHEN_MINUS||r===CHAR_PLUS||r===CHAR_UNDERSCORE||r>127))return t.hostname=o.slice(0,s),\`/\${o.slice(s)}\${e}\`}return e}Url2.prototype.parse=function(t,e,o){let s=!1,r=-1,n=-1,a="",i=0;for(let e=0,o=!1,h=!1;e<t.length;++e){const c=t.charCodeAt(e),l=c===CHAR_SPACE||c===CHAR_TAB||c===CHAR_CARRIAGE_RETURN||c===CHAR_LINE_FEED||c===CHAR_FORM_FEED||c===CHAR_NO_BREAK_SPACE||c===CHAR_ZERO_WIDTH_NOBREAK_SPACE;if(-1===r){if(l)continue;i=r=e}else o?l||(n=-1,o=!1):l&&(n=e,o=!0);if(h)s||c!==CHAR_HASH||(s=!0);else switch(c){case CHAR_HASH:s=!0;case CHAR_QUESTION_MARK:h=!0;break;case CHAR_BACKWARD_SLASH:e-i>0&&(a+=t.slice(i,e)),a+="/",i=e+1}}if(-1!==r&&(i===r?a=-1===n?0===r?t:t.slice(r):t.slice(r,n):-1===n&&i<t.length?a+=t.slice(i):-1!==n&&i<n&&(a+=t.slice(i,n))),!o&&!s){const t=simplePathPattern.exec(a);if(t)return this.path=a,this.href=a,this.pathname=t[1],t[2]?(this.search=t[2],this.query=e?querystring_default.parse(this.search.slice(1)):this.search.slice(1)):e&&(this.search=null,this.query=Object.create(null)),this}let h,c,l=protocolPattern.exec(a);if(l&&(l=l[0],h=l.toLowerCase(),this.protocol=h,a=a.slice(l.length)),(o||l||hostPattern.test(a))&&(c=a.charCodeAt(0)===CHAR_FORWARD_SLASH&&a.charCodeAt(1)===CHAR_FORWARD_SLASH,!c||l&&hostlessProtocol.has(h)||(a=a.slice(2),this.slashes=!0)),!hostlessProtocol.has(h)&&(c||l&&!slashedProtocol.has(l))){let t=-1,e=-1,o=-1;for(let s=0;s<a.length;++s){switch(a.charCodeAt(s)){case CHAR_TAB:case CHAR_LINE_FEED:case CHAR_CARRIAGE_RETURN:case CHAR_SPACE:case CHAR_DOUBLE_QUOTE:case CHAR_PERCENT:case CHAR_SINGLE_QUOTE:case CHAR_SEMICOLON:case CHAR_LEFT_ANGLE_BRACKET:case CHAR_RIGHT_ANGLE_BRACKET:case CHAR_BACKWARD_SLASH:case CHAR_CIRCUMFLEX_ACCENT:case CHAR_GRAVE_ACCENT:case CHAR_LEFT_CURLY_BRACKET:case CHAR_VERTICAL_LINE:case CHAR_RIGHT_CURLY_BRACKET:-1===o&&(o=s);break;case CHAR_HASH:case CHAR_FORWARD_SLASH:case CHAR_QUESTION_MARK:-1===o&&(o=s),t=s;break;case CHAR_AT:e=s,o=-1}if(-1!==t)break}r=0,-1!==e&&(this.auth=decodeURIComponent(a.slice(0,e)),r=e+1),-1===o?(this.host=a.slice(r),a=""):(this.host=a.slice(r,o),a=a.slice(o)),this.parseHost(),"string"!=typeof this.hostname&&(this.hostname="");const s=this.hostname,n=isIpv6Hostname(s);if(n||(a=getHostname(this,a,s)),this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!n&&""!==this.hostname&&(this.hostname=toASCII(this.hostname,!0),""===this.hostname||forbiddenHostChars.test(this.hostname)))throw new Error("invalid URL");const i=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+i,n&&(this.hostname=this.hostname.slice(1,-1),"/"!==a[0]&&(a="/"+a))}unsafeProtocol.has(h)||(a=autoEscapeStr(a));let u=-1,f=-1;for(let t=0;t<a.length;++t){const e=a.charCodeAt(t);if(e===CHAR_HASH){this.hash=a.slice(t),f=t;break}e===CHAR_QUESTION_MARK&&-1===u&&(u=t)}-1!==u?(-1===f?(this.search=a.slice(u),this.query=a.slice(u+1)):(this.search=a.slice(u,f),this.query=a.slice(u+1,f)),e&&(this.query=querystring_default.parse(this.query))):e&&(this.search=null,this.query=Object.create(null));const p=-1!==u&&(-1===f||u<f)?u:f;if(-1===p?a.length>0&&(this.pathname=a):p>0&&(this.pathname=a.slice(0,p)),slashedProtocol.has(h)&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){const t=this.pathname||"",e=this.search||"";this.path=t+e}return this.href=this.format(),this};var escapedCodes=["","","","","","","","","","%09","%0A","","","%0D","","","","","","","","","","","","","","","","","","","%20","","%22","","","","","%27","","","","","","","","","","","","","","","","","","","","","%3C","","%3E","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","%5C","","%5E","","%60","","","","","","","","","","","","","","","","","","","","","","","","","","","%7B","%7C","%7D"];function autoEscapeStr(t){let e="",o=0;for(let s=0;s<t.length;++s){const r=escapedCodes[t.charCodeAt(s)];r&&(s>o&&(e+=t.slice(o,s)),e+=r,o=s+1)}return 0===o?t:(o<t.length&&(e+=t.slice(o)),e)}var cachedSetTimeout,cachedClearTimeout,noEscapeAuth=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);function spliceOne(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function defaultSetTimeout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function Item(t,e){this.fun=t,this.array=e}Url2.prototype.format=function(){let t=this.auth||"";t&&(t=encodeStr(t,noEscapeAuth,hexTable),t+="@");let e=this.protocol||"",o=this.pathname||"",s=this.hash||"",r="",n="";this.host?r=t+this.host:this.hostname&&(r=t+(this.hostname.includes(":")&&!isIpv6Hostname(this.hostname)?"["+this.hostname+"]":this.hostname),this.port&&(r+=":"+this.port)),null!==this.query&&"object"==typeof this.query&&(n=querystring_default.stringify(this.query));let a=this.search||n&&"?"+n||"";e&&58!==e.charCodeAt(e.length-1)&&(e+=":");let i="",h=0;for(let t=0;t<o.length;++t)switch(o.charCodeAt(t)){case CHAR_HASH:t-h>0&&(i+=o.slice(h,t)),i+="%23",h=t+1;break;case CHAR_QUESTION_MARK:t-h>0&&(i+=o.slice(h,t)),i+="%3F",h=t+1}return h>0&&(o=h!==o.length?i+o.slice(h):i),(this.slashes||slashedProtocol.has(e))&&(this.slashes||r?(o&&o.charCodeAt(0)!==CHAR_FORWARD_SLASH&&(o="/"+o),r="//"+r):e.length>=4&&102===e.charCodeAt(0)&&105===e.charCodeAt(1)&&108===e.charCodeAt(2)&&101===e.charCodeAt(3)&&(r="//")),a=a.replace(/#/g,"%23"),s&&s.charCodeAt(0)!==CHAR_HASH&&(s="#"+s),a&&a.charCodeAt(0)!==CHAR_QUESTION_MARK&&(a="?"+a),e+r+o+a+s},Url2.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url2.prototype.resolveObject=function(t){if("string"==typeof t){const e=new Url2;e.parse(t,!1,!0),t=e}const e=new Url2,o=Object.keys(this);for(let t=0;t<o.length;t++){const s=o[t];e[s]=this[s]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){const o=Object.keys(t);for(let s=0;s<o.length;s++){const r=o[s];"protocol"!==r&&(e[r]=t[r])}return slashedProtocol.has(e.protocol)&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!slashedProtocol.has(t.protocol)){const o=Object.keys(t);for(let s=0;s<o.length;s++){const r=o[s];e[r]=t[r]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||/^file:?$/.test(t.protocol)||hostlessProtocol.has(t.protocol))e.pathname=t.pathname;else{const o=(t.pathname||"").split("/");for(;o.length&&!(t.host=o.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),e.pathname=o.join("/")}if(e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,e.pathname||e.search){const t=e.pathname||"",o=e.search||"";e.path=t+o}return e.slashes=e.slashes||t.slashes,e.href=e.format(),e}const s=e.pathname&&"/"===e.pathname.charAt(0),r=t.host||t.pathname&&"/"===t.pathname.charAt(0);let n=r||s||e.host&&t.pathname;const a=n;let i=e.pathname&&e.pathname.split("/")||[];const h=t.pathname&&t.pathname.split("/")||[],c=e.protocol&&!slashedProtocol.has(e.protocol);if(c&&(e.hostname="",e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,e.auth=null,t.host&&(""===h[0]?h[0]=t.host:h.unshift(t.host)),t.host=null),n=n&&(""===h[0]||""===i[0])),r)(t.host||""===t.host)&&(e.host!==t.host&&(e.auth=null),e.host=t.host,e.port=t.port),(t.hostname||""===t.hostname)&&(e.hostname!==t.hostname&&(e.auth=null),e.hostname=t.hostname),e.search=t.search,e.query=t.query,i=h;else if(h.length)i||(i=[]),i.pop(),i=i.concat(h),e.search=t.search,e.query=t.query;else if(null!==t.search&&void 0!==t.search){if(c){e.hostname=e.host=i.shift();const t=e.host&&e.host.indexOf("@")>0&&e.host.split("@");t&&(e.auth=t.shift(),e.host=e.hostname=t.shift())}return e.search=t.search,e.query=t.query,null===e.pathname&&null===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!i.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;let l=i.slice(-1)[0];const u=(e.host||t.host||i.length>1)&&("."===l||".."===l)||""===l;let f=0;for(let t=i.length-1;t>=0;t--)l=i[t],"."===l?spliceOne(i,t):".."===l?(spliceOne(i,t),f++):f&&(spliceOne(i,t),f--);if(!n&&!a)for(;f--;)i.unshift("..");!n||""===i[0]||i[0]&&"/"===i[0].charAt(0)||i.unshift(""),u&&"/"!==i.join("/").substr(-1)&&i.push("");const p=""===i[0]||i[0]&&"/"===i[0].charAt(0);if(c){e.hostname=e.host=p?"":i.length?i.shift():"";const t=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");t&&(e.auth=t.shift(),e.host=e.hostname=t.shift())}return n=n||e.host&&i.length,n&&!p&&i.unshift(""),i.length?e.pathname=i.join("/"):(e.pathname=null,e.path=null),null===e.pathname&&null===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},Url2.prototype.parseHost=function(){let t=this.host,e=portPattern.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.slice(1)),t=t.slice(0,t.length-e.length)),t&&(this.hostname=t)},function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimeout}catch(t){cachedSetTimeout=defaultSetTimeout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){cachedClearTimeout=defaultClearTimeout}}(),Item.prototype.run=function(){this.fun.apply(null,this.array)};var import_text_min5=__toESM(require_text_min(),1),import_text_min4=__toESM(require_text_min(),1),A="other->A";console.log("Hello from agent2",A);"`;

exports[`Should compile the agent > single file agent 1`] = `
"var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__copyProps=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames(t))__hasOwnProp.call(e,o)||o===r||__defProp(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc(t,o))||n.enumerable});return e},__toESM=(e,t,r)=>(r=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?r:__defProp(r,"default",{value:e,enumerable:!0}),e)),require_text_min=__commonJS({"node_modules/.pnpm/fast-text-encoding@1.0.6/node_modules/fast-text-encoding/text.min.js"(e){"use strict";!function(e){function t(e){for(var t=0,r=Math.min(65536,e.length+1),n=new Uint16Array(r),o=[],i=0;;){var s=t<e.length;if(!s||i>=r-1){var a=n.subarray(0,i);if(o.push(String.fromCharCode.apply(null,a)),!s)return o.join("");e=e.subarray(t),t=0,i=0}var c=e[t++];if(0==(128&c))n[i++]=c;else if(192==(224&c)){var u=63&e[t++];n[i++]=(31&c)<<6|u}else if(224==(240&c)){u=63&e[t++];var l=63&e[t++];n[i++]=(31&c)<<12|u<<6|l}else if(240==(248&c)){var f=(7&c)<<18|(u=63&e[t++])<<12|(l=63&e[t++])<<6|63&e[t++];f>65535&&(f-=65536,n[i++]=f>>>10&1023|55296,f=56320|1023&f),n[i++]=f}}}var r="Failed to ",n=function(e,t,n){if(e)throw new Error("".concat(r).concat(t,": the '").concat(n,"' option is unsupported."))},o="function"==typeof Buffer&&Buffer.from,i=o?function(e){return Buffer.from(e)}:function(e){for(var t=0,r=e.length,n=0,o=Math.max(32,r+(r>>>1)+7),i=new Uint8Array(o>>>3<<3);t<r;){var s=e.charCodeAt(t++);if(s>=55296&&s<=56319){if(t<r){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,s=((1023&s)<<10)+(1023&a)+65536)}if(s>=55296&&s<=56319)continue}if(n+4>i.length){o+=8,o=(o*=1+t/e.length*2)>>>3<<3;var c=new Uint8Array(o);c.set(i),i=c}if(0!=(4294967168&s)){if(0==(4294965248&s))i[n++]=s>>>6&31|192;else if(0==(4294901760&s))i[n++]=s>>>12&15|224,i[n++]=s>>>6&63|128;else{if(0!=(4292870144&s))continue;i[n++]=s>>>18&7|240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128}i[n++]=63&s|128}else i[n++]=s}return i.slice?i.slice(0,n):i.subarray(0,n)};function s(){this.encoding="utf-8"}s.prototype.encode=function(e,t){return n(t&&t.stream,"encode","stream"),i(e)};var a=!o&&"function"==typeof Blob&&"function"==typeof Url&&"function"==typeof Url.createObjectURL,c=["utf-8","utf8","unicode-1-1-utf-8"],u=t;o?u=function(e,t){return(e instanceof Buffer?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength)).toString(t)}:a&&(u=function(e){try{return function(e){var t;try{var r=new Blob([e],{type:"text/plain;charset=UTF-8"});t=Url.createObjectURL(r);var n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n.responseText}finally{t&&Url.revokeObjectURL(t)}}(e)}catch(r){return t(e)}});var l="construct 'TextDecoder'",f="".concat(r," ").concat(l,": the ");function p(e,t){if(n(t&&t.fatal,l,"fatal"),e=e||"utf-8",!(o?Buffer.isEncoding(e):-1!==c.indexOf(e.toLowerCase())))throw new RangeError("".concat(f," encoding label provided ('").concat(e,"') is invalid."));this.encoding=e,this.fatal=!1,this.ignoreBOM=!1}p.prototype.decode=function(e,t){var r;return n(t&&t.stream,"decode","stream"),r=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),u(r,this.encoding)},e.TextEncoder=e.TextEncoder||s,e.TextDecoder=e.TextDecoder||p}("undefined"!=typeof window?window:"undefined"!=typeof global?global:e)}}),fridaSetImmediate=globalThis.setImmediate,fridaClearImmediate=globalThis.clearImmediate,import_text_min3=__toESM(require_text_min(),1),import_text_min=__toESM(require_text_min(),1),maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexNonASCII=/[^\\0-\\x7E]/,regexSeparators=/[\\x2E\\u3002\\uFF0E\\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(e){throw new RangeError(errors[e])}function map(e,t){const r=[];let n=e.length;for(;n--;)r[n]=t(e[n]);return r}function mapDomain(e,t){const r=e.split("@");let n="";r.length>1&&(n=r[0]+"@",e=r[1]);return n+map((e=e.replace(regexSeparators,".")).split("."),t).join(".")}function ucs2decode(e){const t=[];let r=0;const n=e.length;for(;r<n;){const o=e.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){const n=e.charCodeAt(r++);56320==(64512&n)?t.push(((1023&o)<<10)+(1023&n)+65536):(t.push(o),r--)}else t.push(o)}return t}var digitToBasic=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},adapt=function(e,t,r){let n=0;for(e=r?floor(e/damp):e>>1,e+=floor(e/t);e>baseMinusTMin*tMax>>1;n+=base)e=floor(e/baseMinusTMin);return floor(n+(baseMinusTMin+1)*e/(e+skew))};function encode(e){const t=[];let r=(e=ucs2decode(e)).length,n=initialN,o=0,i=initialBias;for(const r of e)r<128&&t.push(stringFromCharCode(r));let s=t.length,a=s;for(s&&t.push(delimiter);a<r;){let r=maxInt;for(const t of e)t>=n&&t<r&&(r=t);const c=a+1;r-n>floor((maxInt-o)/c)&&error("overflow"),o+=(r-n)*c,n=r;for(const r of e)if(r<n&&++o>maxInt&&error("overflow"),r==n){let e=o;for(let r=base;;r+=base){const n=r<=i?tMin:r>=i+tMax?tMax:r-i;if(e<n)break;const o=e-n,s=base-n;t.push(stringFromCharCode(digitToBasic(n+o%s,0))),e=floor(o/s)}t.push(stringFromCharCode(digitToBasic(e,0))),i=adapt(o,c,a==s),o=0,++a}++o,++n}return t.join("")}function toASCII(e){return mapDomain(e,(function(e){return regexNonASCII.test(e)?"xn--"+encode(e):e}))}var import_text_min2=__toESM(require_text_min(),1);function stringify(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((n=>{const o=encodeURIComponent(stringifyPrimitive(n))+r;return Array.isArray(e[n])?e[n].map((function(e){return o+encodeURIComponent(stringifyPrimitive(e))})).join(t):o+encodeURIComponent(stringifyPrimitive(e[n]))})).filter(Boolean).join(t):n?encodeURIComponent(stringifyPrimitive(n))+r+encodeURIComponent(stringifyPrimitive(e)):""}function stringifyPrimitive(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function parse(e,t,r,n){t=t||"&",r=r||"=";const o={};if("string"!=typeof e||0===e.length)return o;const i=/\\+/g;e=e.split(t);let s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);let a=e.length;s>0&&a>s&&(a=s);for(let t=0;t<a;t++){const n=e[t].replace(i,"%20");let s,a;const c=n.indexOf(r);c>=0?(s=n.substr(0,c),a=n.substr(c+1)):(s=n,a="");const u=decodeURIComponent(s),l=decodeURIComponent(a);Object.prototype.hasOwnProperty.call(o,u)?Array.isArray(o[u])?o[u].push(l):o[u]=[o[u],l]:o[u]=l}return o}var querystring_default={stringify:stringify,encode:stringify,parse:parse,decode:parse};function Url2(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^[a-z0-9.+-]+:/i,portPattern=/:[0-9]*$/,hostPattern=/^\\/\\/[^@/]+@[^@/]+/,simplePathPattern=/^(\\/\\/?(?!\\/)[^?\\s]*)(\\?[^\\s]*)?$/,hostnameMaxLen=255,unsafeProtocol=new Set(["javascript","javascript:"]),hostlessProtocol=new Set(["javascript","javascript:"]),slashedProtocol=new Set(["http","http:","https","https:","ftp","ftp:","gopher","gopher:","file","file:","ws","ws:","wss","wss:"]),CHAR_SPACE=32,CHAR_TAB=9,CHAR_CARRIAGE_RETURN=13,CHAR_LINE_FEED=10,CHAR_FORM_FEED=12,CHAR_NO_BREAK_SPACE=160,CHAR_ZERO_WIDTH_NOBREAK_SPACE=65279,CHAR_HASH=35,CHAR_FORWARD_SLASH=47,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_LEFT_ANGLE_BRACKET=60,CHAR_RIGHT_ANGLE_BRACKET=62,CHAR_LEFT_CURLY_BRACKET=123,CHAR_RIGHT_CURLY_BRACKET=125,CHAR_QUESTION_MARK=63,CHAR_LOWERCASE_A=97,CHAR_LOWERCASE_Z=122,CHAR_UPPERCASE_A=65,CHAR_UPPERCASE_Z=90,CHAR_DOT=46,CHAR_0=48,CHAR_9=57,CHAR_HYPHEN_MINUS=45,CHAR_PLUS=43,CHAR_UNDERSCORE=95,CHAR_DOUBLE_QUOTE=34,CHAR_SINGLE_QUOTE=39,CHAR_PERCENT=37,CHAR_SEMICOLON=59,CHAR_BACKWARD_SLASH=92,CHAR_CIRCUMFLEX_ACCENT=94,CHAR_GRAVE_ACCENT=96,CHAR_VERTICAL_LINE=124,CHAR_AT=64;function urlParse(e,t,r){if(e instanceof Url2)return e;const n=new Url2;return n.parse(e,t,r),n}function isIpv6Hostname(e){return e.charCodeAt(0)===CHAR_LEFT_SQUARE_BRACKET&&e.charCodeAt(e.length-1)===CHAR_RIGHT_SQUARE_BRACKET}var forbiddenHostChars=/[\\t\\n\\r #%/:<>?@[\\\\\\]^|]/;function getHostname(e,t,r){for(let n=0;n<r.length;++n){const o=r.charCodeAt(n);if(!(o>=CHAR_LOWERCASE_A&&o<=CHAR_LOWERCASE_Z||o===CHAR_DOT||o>=CHAR_UPPERCASE_A&&o<=CHAR_UPPERCASE_Z||o>=CHAR_0&&o<=CHAR_9||o===CHAR_HYPHEN_MINUS||o===CHAR_PLUS||o===CHAR_UNDERSCORE||o>127))return e.hostname=r.slice(0,n),\`/\${r.slice(n)}\${t}\`}return t}Url2.prototype.parse=function(e,t,r){let n=!1,o=-1,i=-1,s="",a=0;for(let t=0,r=!1,c=!1;t<e.length;++t){const u=e.charCodeAt(t),l=u===CHAR_SPACE||u===CHAR_TAB||u===CHAR_CARRIAGE_RETURN||u===CHAR_LINE_FEED||u===CHAR_FORM_FEED||u===CHAR_NO_BREAK_SPACE||u===CHAR_ZERO_WIDTH_NOBREAK_SPACE;if(-1===o){if(l)continue;a=o=t}else r?l||(i=-1,r=!1):l&&(i=t,r=!0);if(c)n||u!==CHAR_HASH||(n=!0);else switch(u){case CHAR_HASH:n=!0;case CHAR_QUESTION_MARK:c=!0;break;case CHAR_BACKWARD_SLASH:t-a>0&&(s+=e.slice(a,t)),s+="/",a=t+1}}if(-1!==o&&(a===o?s=-1===i?0===o?e:e.slice(o):e.slice(o,i):-1===i&&a<e.length?s+=e.slice(a):-1!==i&&a<i&&(s+=e.slice(a,i))),!r&&!n){const e=simplePathPattern.exec(s);if(e)return this.path=s,this.href=s,this.pathname=e[1],e[2]?(this.search=e[2],this.query=t?querystring_default.parse(this.search.slice(1)):this.search.slice(1)):t&&(this.search=null,this.query=Object.create(null)),this}let c,u,l=protocolPattern.exec(s);if(l&&(l=l[0],c=l.toLowerCase(),this.protocol=c,s=s.slice(l.length)),(r||l||hostPattern.test(s))&&(u=s.charCodeAt(0)===CHAR_FORWARD_SLASH&&s.charCodeAt(1)===CHAR_FORWARD_SLASH,!u||l&&hostlessProtocol.has(c)||(s=s.slice(2),this.slashes=!0)),!hostlessProtocol.has(c)&&(u||l&&!slashedProtocol.has(l))){let e=-1,t=-1,r=-1;for(let n=0;n<s.length;++n){switch(s.charCodeAt(n)){case CHAR_TAB:case CHAR_LINE_FEED:case CHAR_CARRIAGE_RETURN:case CHAR_SPACE:case CHAR_DOUBLE_QUOTE:case CHAR_PERCENT:case CHAR_SINGLE_QUOTE:case CHAR_SEMICOLON:case CHAR_LEFT_ANGLE_BRACKET:case CHAR_RIGHT_ANGLE_BRACKET:case CHAR_BACKWARD_SLASH:case CHAR_CIRCUMFLEX_ACCENT:case CHAR_GRAVE_ACCENT:case CHAR_LEFT_CURLY_BRACKET:case CHAR_VERTICAL_LINE:case CHAR_RIGHT_CURLY_BRACKET:-1===r&&(r=n);break;case CHAR_HASH:case CHAR_FORWARD_SLASH:case CHAR_QUESTION_MARK:-1===r&&(r=n),e=n;break;case CHAR_AT:t=n,r=-1}if(-1!==e)break}o=0,-1!==t&&(this.auth=decodeURIComponent(s.slice(0,t)),o=t+1),-1===r?(this.host=s.slice(o),s=""):(this.host=s.slice(o,r),s=s.slice(r)),this.parseHost(),"string"!=typeof this.hostname&&(this.hostname="");const n=this.hostname,i=isIpv6Hostname(n);if(i||(s=getHostname(this,s,n)),this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!i&&""!==this.hostname&&(this.hostname=toASCII(this.hostname,!0),""===this.hostname||forbiddenHostChars.test(this.hostname)))throw new Error("invalid URL");const a=this.port?":"+this.port:"",c=this.hostname||"";this.host=c+a,i&&(this.hostname=this.hostname.slice(1,-1),"/"!==s[0]&&(s="/"+s))}unsafeProtocol.has(c)||(s=autoEscapeStr(s));let f=-1,p=-1;for(let e=0;e<s.length;++e){const t=s.charCodeAt(e);if(t===CHAR_HASH){this.hash=s.slice(e),p=e;break}t===CHAR_QUESTION_MARK&&-1===f&&(f=e)}-1!==f?(-1===p?(this.search=s.slice(f),this.query=s.slice(f+1)):(this.search=s.slice(f,p),this.query=s.slice(f+1,p)),t&&(this.query=querystring_default.parse(this.query))):t&&(this.search=null,this.query=Object.create(null));const h=-1!==f&&(-1===p||f<p)?f:p;if(-1===h?s.length>0&&(this.pathname=s):h>0&&(this.pathname=s.slice(0,h)),slashedProtocol.has(c)&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){const e=this.pathname||"",t=this.search||"";this.path=e+t}return this.href=this.format(),this};var escapedCodes=["","","","","","","","","","%09","%0A","","","%0D","","","","","","","","","","","","","","","","","","","%20","","%22","","","","","%27","","","","","","","","","","","","","","","","","","","","","%3C","","%3E","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","%5C","","%5E","","%60","","","","","","","","","","","","","","","","","","","","","","","","","","","%7B","%7C","%7D"];function autoEscapeStr(e){let t="",r=0;for(let n=0;n<e.length;++n){const o=escapedCodes[e.charCodeAt(n)];o&&(n>r&&(t+=e.slice(r,n)),t+=o,r=n+1)}return 0===r?e:(r<e.length&&(t+=e.slice(r)),t)}var cachedSetTimeout,cachedClearTimeout,noEscapeAuth=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function defaultSetTimeout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimeout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}Url2.prototype.format=function(){let e=this.auth||"";e&&(e=encodeStr(e,noEscapeAuth,hexTable),e+="@");let t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o="",i="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.includes(":")&&!isIpv6Hostname(this.hostname)?"["+this.hostname+"]":this.hostname),this.port&&(o+=":"+this.port)),null!==this.query&&"object"==typeof this.query&&(i=querystring_default.stringify(this.query));let s=this.search||i&&"?"+i||"";t&&58!==t.charCodeAt(t.length-1)&&(t+=":");let a="",c=0;for(let e=0;e<r.length;++e)switch(r.charCodeAt(e)){case CHAR_HASH:e-c>0&&(a+=r.slice(c,e)),a+="%23",c=e+1;break;case CHAR_QUESTION_MARK:e-c>0&&(a+=r.slice(c,e)),a+="%3F",c=e+1}return c>0&&(r=c!==r.length?a+r.slice(c):a),(this.slashes||slashedProtocol.has(t))&&(this.slashes||o?(r&&r.charCodeAt(0)!==CHAR_FORWARD_SLASH&&(r="/"+r),o="//"+o):t.length>=4&&102===t.charCodeAt(0)&&105===t.charCodeAt(1)&&108===t.charCodeAt(2)&&101===t.charCodeAt(3)&&(o="//")),s=s.replace(/#/g,"%23"),n&&n.charCodeAt(0)!==CHAR_HASH&&(n="#"+n),s&&s.charCodeAt(0)!==CHAR_QUESTION_MARK&&(s="?"+s),t+o+r+s+n},Url2.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url2.prototype.resolveObject=function(e){if("string"==typeof e){const t=new Url2;t.parse(e,!1,!0),e=t}const t=new Url2,r=Object.keys(this);for(let e=0;e<r.length;e++){const n=r[e];t[n]=this[n]}if(t.hash=e.hash,""===e.href)return t.href=t.format(),t;if(e.slashes&&!e.protocol){const r=Object.keys(e);for(let n=0;n<r.length;n++){const o=r[n];"protocol"!==o&&(t[o]=e[o])}return slashedProtocol.has(t.protocol)&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(e.protocol&&e.protocol!==t.protocol){if(!slashedProtocol.has(e.protocol)){const r=Object.keys(e);for(let n=0;n<r.length;n++){const o=r[n];t[o]=e[o]}return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||/^file:?$/.test(e.protocol)||hostlessProtocol.has(e.protocol))t.pathname=e.pathname;else{const r=(e.pathname||"").split("/");for(;r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),t.pathname=r.join("/")}if(t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,t.pathname||t.search){const e=t.pathname||"",r=t.search||"";t.path=e+r}return t.slashes=t.slashes||e.slashes,t.href=t.format(),t}const n=t.pathname&&"/"===t.pathname.charAt(0),o=e.host||e.pathname&&"/"===e.pathname.charAt(0);let i=o||n||t.host&&e.pathname;const s=i;let a=t.pathname&&t.pathname.split("/")||[];const c=e.pathname&&e.pathname.split("/")||[],u=t.protocol&&!slashedProtocol.has(t.protocol);if(u&&(t.hostname="",t.port=null,t.host&&(""===a[0]?a[0]=t.host:a.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,t.auth=null,e.host&&(""===c[0]?c[0]=e.host:c.unshift(e.host)),e.host=null),i=i&&(""===c[0]||""===a[0])),o)(e.host||""===e.host)&&(t.host!==e.host&&(t.auth=null),t.host=e.host,t.port=e.port),(e.hostname||""===e.hostname)&&(t.hostname!==e.hostname&&(t.auth=null),t.hostname=e.hostname),t.search=e.search,t.query=e.query,a=c;else if(c.length)a||(a=[]),a.pop(),a=a.concat(c),t.search=e.search,t.query=e.query;else if(null!==e.search&&void 0!==e.search){if(u){t.hostname=t.host=a.shift();const e=t.host&&t.host.indexOf("@")>0&&t.host.split("@");e&&(t.auth=e.shift(),t.host=t.hostname=e.shift())}return t.search=e.search,t.query=e.query,null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!a.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;let l=a.slice(-1)[0];const f=(t.host||e.host||a.length>1)&&("."===l||".."===l)||""===l;let p=0;for(let e=a.length-1;e>=0;e--)l=a[e],"."===l?spliceOne(a,e):".."===l?(spliceOne(a,e),p++):p&&(spliceOne(a,e),p--);if(!i&&!s)for(;p--;)a.unshift("..");!i||""===a[0]||a[0]&&"/"===a[0].charAt(0)||a.unshift(""),f&&"/"!==a.join("/").substr(-1)&&a.push("");const h=""===a[0]||a[0]&&"/"===a[0].charAt(0);if(u){t.hostname=t.host=h?"":a.length?a.shift():"";const e=!!(t.host&&t.host.indexOf("@")>0)&&t.host.split("@");e&&(t.auth=e.shift(),t.host=t.hostname=e.shift())}return i=i||t.host&&a.length,i&&!h&&a.unshift(""),a.length?t.pathname=a.join("/"):(t.pathname=null,t.path=null),null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},Url2.prototype.parseHost=function(){let e=this.host,t=portPattern.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.slice(1)),e=e.slice(0,e.length-t.length)),e&&(this.hostname=e)},function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimeout}catch(e){cachedSetTimeout=defaultSetTimeout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(draining)return;const e=runTimeout(cleanUpNextTick);draining=!0;let t=queue.length;for(;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}function nextTick(e,...t){queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",browser=!0,env={},argv=[],version="",versions={};function noop(){}var on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop,prependListener=noop,prependOnceListener=noop,listeners=function(e){return[]};function binding(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}var browser_default={nextTick:nextTick,title:title,browser:browser,env:env,argv:argv,version:version,versions:versions,on:on,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,prependListener:prependListener,prependOnceListener:prependOnceListener,listeners:listeners,binding:binding,cwd:cwd,chdir:chdir,umask:umask},import_text_min11=__toESM(require_text_min(),1),import_text_min10=__toESM(require_text_min(),1),import_text_min7=__toESM(require_text_min(),1),import_text_min6=__toESM(require_text_min(),1),types_exports={};__export(types_exports,{isAnyArrayBuffer:()=>isAnyArrayBuffer,isArgumentsObject:()=>isArgumentsObject,isArrayBuffer:()=>isArrayBuffer,isArrayBufferView:()=>isArrayBufferView,isAsyncFunction:()=>isAsyncFunction,isBigInt64Array:()=>isBigInt64Array,isBigIntObject:()=>isBigIntObject,isBigUint64Array:()=>isBigUint64Array,isBooleanObject:()=>isBooleanObject,isBoxedPrimitive:()=>isBoxedPrimitive,isDataView:()=>isDataView,isExternal:()=>isExternal,isFloat32Array:()=>isFloat32Array,isFloat64Array:()=>isFloat64Array,isGeneratorFunction:()=>isGeneratorFunction,isGeneratorObject:()=>isGeneratorObject,isInt16Array:()=>isInt16Array,isInt32Array:()=>isInt32Array,isInt8Array:()=>isInt8Array,isMap:()=>isMap,isMapIterator:()=>isMapIterator,isModuleNamespaceObject:()=>isModuleNamespaceObject,isNumberObject:()=>isNumberObject,isPromise:()=>isPromise,isProxy:()=>isProxy,isSet:()=>isSet,isSetIterator:()=>isSetIterator,isSharedArrayBuffer:()=>isSharedArrayBuffer,isStringObject:()=>isStringObject,isSymbolObject:()=>isSymbolObject,isTypedArray:()=>isTypedArray,isUint16Array:()=>isUint16Array,isUint32Array:()=>isUint32Array,isUint8Array:()=>isUint8Array,isUint8ClampedArray:()=>isUint8ClampedArray,isWeakMap:()=>isWeakMap,isWeakSet:()=>isWeakSet,isWebAssemblyCompiledModule:()=>isWebAssemblyCompiledModule});var import_text_min4=__toESM(require_text_min(),1),ObjectToString=uncurryThis(Object.prototype.toString),numberValue=uncurryThis(Number.prototype.valueOf),stringValue=uncurryThis(String.prototype.valueOf),booleanValue=uncurryThis(Boolean.prototype.valueOf),bigIntValue=uncurryThis(BigInt.prototype.valueOf),symbolValue=uncurryThis(Symbol.prototype.valueOf),generatorPrototype=Object.getPrototypeOf((function*(){})),typedArrayPrototype=Object.getPrototypeOf(Int8Array);function isArgumentsObject(e){return(null===e||"object"!=typeof e||!(Symbol.toStringTag in e))&&"[object Arguments]"===ObjectToString(e)}function isGeneratorFunction(e){return Object.getPrototypeOf(e)===generatorPrototype}function isTypedArray(e){return e instanceof typedArrayPrototype}function isPromise(e){return e instanceof Promise}function isArrayBufferView(e){return ArrayBuffer.isView(e)}function isUint8Array(e){return e instanceof Uint8Array}function isUint8ClampedArray(e){return e instanceof Uint8ClampedArray}function isUint16Array(e){return e instanceof Uint16Array}function isUint32Array(e){return e instanceof Uint32Array}function isInt8Array(e){return e instanceof Int8Array}function isInt16Array(e){return e instanceof Int16Array}function isInt32Array(e){return e instanceof Int32Array}function isFloat32Array(e){return e instanceof Float32Array}function isFloat64Array(e){return e instanceof Float64Array}function isBigInt64Array(e){return e instanceof BigInt64Array}function isBigUint64Array(e){return e instanceof BigUint64Array}function isMap(e){return"[object Map]"===ObjectToString(e)}function isSet(e){return"[object Set]"===ObjectToString(e)}function isWeakMap(e){return"[object WeakMap]"===ObjectToString(e)}function isWeakSet(e){return"[object WeakSet]"===ObjectToString(e)}function isArrayBuffer(e){return"[object ArrayBuffer]"===ObjectToString(e)}function isDataView(e){return"[object DataView]"===ObjectToString(e)}function isSharedArrayBuffer(e){return"[object SharedArrayBuffer]"===ObjectToString(e)}function isAsyncFunction(e){return"[object AsyncFunction]"===ObjectToString(e)}function isMapIterator(e){return"[object Map Iterator]"===ObjectToString(e)}function isSetIterator(e){return"[object Set Iterator]"===ObjectToString(e)}function isGeneratorObject(e){return"[object Generator]"===ObjectToString(e)}function isWebAssemblyCompiledModule(e){return"[object WebAssembly.Module]"===ObjectToString(e)}function isNumberObject(e){return checkBoxedPrimitive(e,numberValue)}function isStringObject(e){return checkBoxedPrimitive(e,stringValue)}function isBooleanObject(e){return checkBoxedPrimitive(e,booleanValue)}function isBigIntObject(e){return checkBoxedPrimitive(e,bigIntValue)}function isSymbolObject(e){return checkBoxedPrimitive(e,symbolValue)}function checkBoxedPrimitive(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function isBoxedPrimitive(e){return isNumberObject(e)||isStringObject(e)||isBooleanObject(e)||isBigIntObject(e)||isSymbolObject(e)}function isAnyArrayBuffer(e){return isArrayBuffer(e)||isSharedArrayBuffer(e)}function isProxy(e){throwNotSupported("isProxy")}function isExternal(e){throwNotSupported("isExternal")}function isModuleNamespaceObject(e){throwNotSupported("isModuleNamespaceObject")}function throwNotSupported(e){throw new Error(\`\${e} is not supported in userland\`)}function uncurryThis(e){return e.call.bind(e)}var import_text_min5=__toESM(require_text_min(),1);function nextTick2(e,...t){Script.nextTick(e,...t)}var title2="Frida",browser2=!1,platform=detectPlatform(),pid=Process.id,env2={FRIDA_COMPILE:"1"},argv2=[],version2=Frida.version,versions2={};function noop2(){}var on2=noop2,addListener2=noop2,once2=noop2,off2=noop2,removeListener2=noop2,removeAllListeners2=noop2,emit2=noop2,prependListener2=noop2,prependOnceListener2=noop2,listeners2=function(e){return[]};function binding2(e){throw new Error("process.binding is not supported")}function cwd2(){return"windows"===Process.platform?"C:\\\\":"/"}function chdir2(e){throw new Error("process.chdir is not supported")}function umask2(){return 0}var process_default={nextTick:nextTick2,title:title2,browser:browser2,platform:platform,pid:pid,env:env2,argv:argv2,version:version2,versions:versions2,on:on2,addListener:addListener2,once:once2,off:off2,removeListener:removeListener2,removeAllListeners:removeAllListeners2,emit:emit2,prependListener:prependListener2,prependOnceListener:prependOnceListener2,listeners:listeners2,binding:binding2,cwd:cwd2,chdir:chdir2,umask:umask2};function detectPlatform(){const e=Process.platform;return"windows"===e?"win32":e}var types={...types_exports,isRegExp:isRegExp,isDate:isDate,isNativeError:isError},util_default={format:format2,deprecate:deprecate,debuglog:debuglog,inspect:inspect,types:types,isArray:isArray,isBoolean:isBoolean,isNull:isNull,isNullOrUndefined:isNullOrUndefined,isNumber:isNumber,isString:isString,isSymbol:isSymbol,isUndefined:isUndefined,isRegExp:isRegExp,isObject:isObject,isDate:isDate,isError:isError,isFunction:isFunction,isPrimitive:isPrimitive,isBuffer:isBuffer,log:log,inherits:inherits,_extend:_extend,promisify:promisify,callbackify:callbackify},formatRegExp=/%[sdj%]/g;function format2(e){if(!isString(e)){const e=[];for(let t=0;t<arguments.length;t++)e.push(inspect(arguments[t]));return e.join(" ")}let t=1;const r=arguments,n=r.length;let o=String(e).replace(formatRegExp,(function(e){if("%%"===e)return"%";if(t>=n)return e;switch(e){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch(e){return"[Circular]"}default:return e}}));for(let e=r[t];t<n;e=r[++t])isNull(e)||!isObject(e)?o+=" "+e:o+=" "+inspect(e);return o}function deprecate(e,t){if(!0===process_default.noDeprecation)return e;let r=!1;return function(){if(!r){if(process_default.throwDeprecation)throw new Error(t);process_default.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}}var debugs={},debugEnvRegex=/^$/;if(process_default.env.NODE_DEBUG){let e=process_default.env.NODE_DEBUG;e=e.replace(/[|\\\\{}()[\\]^$+?.]/g,"\\\\$&").replace(/\\*/g,".*").replace(/,/g,"$|^").toUpperCase(),debugEnvRegex=new RegExp("^"+e+"$","i")}function debuglog(e){if(e=e.toUpperCase(),!debugs[e])if(debugEnvRegex.test(e)){const t=process_default.pid;debugs[e]=function(){const r=format2.apply(null,arguments);console.error("%s %d: %s",e,t,r)}}else debugs[e]=function(){};return debugs[e]}function inspect(e,t){const r={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),isBoolean(t)?r.showHidden=t:t&&_extend(r,t),isUndefined(r.showHidden)&&(r.showHidden=!1),isUndefined(r.depth)&&(r.depth=2),isUndefined(r.colors)&&(r.colors=!1),isUndefined(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=stylizeWithColor),formatValue(r,e,r.depth)}function stylizeWithColor(e,t){const r=inspect.styles[t];return r?"["+inspect.colors[r][0]+"m"+e+"["+inspect.colors[r][1]+"m":e}function stylizeNoColor(e,t){return e}function arrayToHash(e){const t={};return e.forEach((function(e,r){t[e]=!0})),t}function formatValue(e,t,r){if(e.customInspect&&t&&isFunction(t.inspect)&&t.inspect!==inspect&&(!t.constructor||t.constructor.prototype!==t)){let n=t.inspect(r,e);return isString(n)||(n=formatValue(e,n,r)),n}const n=formatPrimitive(e,t);if(n)return n;let o=Object.keys(t);const i=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),isError(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(t);if(0===o.length){if(isFunction(t)){const r=t.name?": "+t.name:"";return e.stylize("[Function"+r+"]","special")}if(isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}let s,a="",c=!1,u=["{","}"];if(isArray(t)&&(c=!0,u=["[","]"]),isFunction(t)){a=" [Function"+(t.name?": "+t.name:"")+"]"}return isRegExp(t)&&(a=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(a=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(a=" "+formatError(t)),0!==o.length||c&&0!=t.length?r<0?isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),s=c?formatArray(e,t,r,i,o):o.map((function(n){return formatProperty(e,t,r,i,n,c)})),e.seen.pop(),reduceToSingleString(s,a,u)):u[0]+a+u[1]}function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){const r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\\\'").replace(/\\\\"/g,'"')+"'";return e.stylize(r,"string")}return isNumber(t)?e.stylize(""+t,"number"):isBoolean(t)?e.stylize(""+t,"boolean"):isNull(t)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,t,r,n,o){const i=[];for(let o=0,s=t.length;o<s;++o)hasOwnProperty(t,String(o))?i.push(formatProperty(e,t,r,n,String(o),!0)):i.push("");return o.forEach((function(o){o.match(/^\\d+$/)||i.push(formatProperty(e,t,r,n,o,!0))})),i}function formatProperty(e,t,r,n,o,i){let s,a,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),hasOwnProperty(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=isNull(r)?formatValue(e,c.value,null):formatValue(e,c.value,r-1),a.indexOf("\\n")>-1&&(a=i?a.split("\\n").map((function(e){return"  "+e})).join("\\n").substr(2):"\\n"+a.split("\\n").map((function(e){return"   "+e})).join("\\n"))):a=e.stylize("[Circular]","special")),isUndefined(s)){if(i&&o.match(/^\\d+$/))return a;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\\\'").replace(/\\\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function reduceToSingleString(e,t,r){return e.reduce((function(e,t){return t.indexOf("\\n")>=0&&0,e+t.replace(/\\u001b\\[\\d\\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\\n ")+" "+e.join(",\\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function isBuffer(e){return e instanceof Buffer}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}inspect.custom=Symbol.for("nodejs.util.inspect.custom"),inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){const e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],t].join(" ")}function log(){console.log("%s - %s",timestamp(),format2.apply(null,arguments))}function inherits(e,t){Object.defineProperty(e,"super_",{value:t,writable:!0,configurable:!0}),Object.setPrototypeOf(e.prototype,t.prototype)}function _extend(e,t){if(!t||!isObject(t))return e;const r=Object.keys(t);let n=r.length;for(;n--;)e[r[n]]=t[r[n]];return e}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var kCustomPromisifiedSymbol=Symbol("util.promisify.custom");function promisify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&e[kCustomPromisifiedSymbol]){const t=e[kCustomPromisifiedSymbol];if("function"!=typeof t)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,kCustomPromisifiedSymbol,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){let t,r;const n=new Promise((function(e,n){t=e,r=n})),o=[];for(let e=0;e<arguments.length;e++)o.push(arguments[e]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),kCustomPromisifiedSymbol&&Object.defineProperty(t,kCustomPromisifiedSymbol,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,Object.getOwnPropertyDescriptors(e))}function callbackifyOnRejected(e,t){if(!e){const t=new Error("Promise was rejected with a falsy value");t.reason=e,e=t}return t(e)}function callbackify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){const t=[];for(let e=0;e<arguments.length;e++)t.push(arguments[e]);const r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");const n=this,o=function(){return r.apply(n,arguments)};e.apply(this,t).then((function(e){process_default.nextTick(o.bind(null,null,e))}),(function(e){process_default.nextTick(callbackifyOnRejected.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),t}promisify.custom=kCustomPromisifiedSymbol;var codes={};function createErrorType(e,t,r){r||(r=Error);codes[e]=class extends r{constructor(r,n,o){super(function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,o)),this.code=e}}}function oneOf(e,t){if(Array.isArray(e)){const r=e.length;return e=e.map((e=>String(e))),r>2?\`one of \${t} \${e.slice(0,r-1).join(", ")}, or \`+e[r-1]:2===r?\`one of \${t} \${e[0]} or \${e[1]}\`:\`of \${t} \${e[0]}\`}return\`of \${t} \${String(e)}\`}function startsWith(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function endsWith(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function includes(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}createErrorType("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),createErrorType("ERR_INVALID_ARG_TYPE",((e,t,r)=>{let n,o;if("string"==typeof t&&startsWith(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be",endsWith(e," argument"))o=\`The \${e} \${n} \${oneOf(t,"type")}\`;else{o=\`The "\${e}" \${includes(e,".")?"property":"argument"} \${n} \${oneOf(t,"type")}\`}return o+=". Received type "+typeof r,o}),TypeError),createErrorType("ERR_INVALID_ARG_VALUE",((e,t,r="is invalid")=>{let n=util_default.inspect(t);return n.length>128&&(n=\`\${n.slice(0,128)}...\`),\`The argument '\${e}' \${r}. Received \${n}\`}),TypeError,RangeError),createErrorType("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{let n;return n=r&&r.constructor&&r.constructor.name?\`instance of \${r.constructor.name}\`:"type "+typeof r,\`Expected \${e} to be returned from the "\${t}" function but got \${n}.\`}),TypeError),createErrorType("ERR_MISSING_ARGS",((...e)=>{let t="The ";const r=e.length;switch(e=e.map((e=>\`"\${e}"\`)),r){case 1:t+=\`\${e[0]} argument\`;break;case 2:t+=\`\${e[0]} and \${e[1]} arguments\`;break;default:t+=e.slice(0,r-1).join(", "),t+=\`, and \${e[r-1]} arguments\`}return\`\${t} must be specified\`}),TypeError);var import_text_min8=__toESM(require_text_min(),1),{ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE}=codes;function endsWith2(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function repeat(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var r=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+=e.substring(0,r-e.length)}var blue="",green="",red="",white="",kReadableOperator={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},kMaxShortLength=10;function copyError(e){const t=Object.keys(e),r=Object.create(Object.getPrototypeOf(e));return t.forEach((t=>{r[t]=e[t]})),Object.defineProperty(r,"message",{value:e.message}),r}function inspectValue(e){return inspect(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function createErrDiff(e,t,r){let n="",o="",i=0,s="",a=!1;const c=inspectValue(e),u=c.split("\\n"),l=inspectValue(t).split("\\n");let f=0,p="";if("strictEqual"===r&&"object"==typeof e&&"object"==typeof t&&null!==e&&null!==t&&(r="strictEqualObject"),1===u.length&&1===l.length&&u[0]!==l[0]){const n=u[0].length+l[0].length;if(n<=kMaxShortLength){if(!("object"==typeof e&&null!==e||"object"==typeof t&&null!==t||0===e&&0===t))return\`\${kReadableOperator[r]}\\n\\n\${u[0]} !== \${l[0]}\\n\`}else if("strictEqualObject"!==r){if(n<(browser_default.stderr&&browser_default.stderr.isTTY?browser_default.stderr.columns:80)){for(;u[0][f]===l[0][f];)f++;f>2&&(p=\`\\n  \${repeat(" ",f)}^\`,f=0)}}}let h=u[u.length-1],m=l[l.length-1];for(;h===m&&(f++<2?s=\`\\n  \${h}\${s}\`:n=h,u.pop(),l.pop(),0!==u.length&&0!==l.length);)h=u[u.length-1],m=l[l.length-1];const d=Math.max(u.length,l.length);if(0===d){const e=c.split("\\n");if(e.length>30)for(e[26]=\`\${blue}...\${white}\`;e.length>27;)e.pop();return\`\${kReadableOperator.notIdentical}\\n\\n\${e.join("\\n")}\\n\`}f>3&&(s=\`\\n\${blue}...\${white}\${s}\`,a=!0),""!==n&&(s=\`\\n  \${n}\${s}\`,n="");let g=0;const y=kReadableOperator[r]+\`\\n\${green}+ actual\${white} \${red}- expected\${white}\`,E=\` \${blue}...\${white} Lines skipped\`;for(f=0;f<d;f++){const e=f-i;if(u.length<f+1)e>1&&f>2&&(e>4?(o+=\`\\n\${blue}...\${white}\`,a=!0):e>3&&(o+=\`\\n  \${l[f-2]}\`,g++),o+=\`\\n  \${l[f-1]}\`,g++),i=f,n+=\`\\n\${red}-\${white} \${l[f]}\`,g++;else if(l.length<f+1)e>1&&f>2&&(e>4?(o+=\`\\n\${blue}...\${white}\`,a=!0):e>3&&(o+=\`\\n  \${u[f-2]}\`,g++),o+=\`\\n  \${u[f-1]}\`,g++),i=f,o+=\`\\n\${green}+\${white} \${u[f]}\`,g++;else{const t=l[f];let r=u[f],s=r!==t&&(!endsWith2(r,",")||r.slice(0,-1)!==t);s&&endsWith2(t,",")&&t.slice(0,-1)===r&&(s=!1,r+=","),s?(e>1&&f>2&&(e>4?(o+=\`\\n\${blue}...\${white}\`,a=!0):e>3&&(o+=\`\\n  \${u[f-2]}\`,g++),o+=\`\\n  \${u[f-1]}\`,g++),i=f,o+=\`\\n\${green}+\${white} \${r}\`,n+=\`\\n\${red}-\${white} \${t}\`,g+=2):(o+=n,n="",1!==e&&0!==f||(o+=\`\\n  \${r}\`,g++))}if(g>20&&f<d-2)return\`\${y}\${E}\\n\${o}\\n\${blue}...\${white}\${n}\\n\${blue}...\${white}\`}return\`\${y}\${a?E:""}\\n\${o}\${n}\${s}\${p}\`}var AssertionError=class extends Error{constructor(e){if("object"!=typeof e||null===e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);const{message:t,operator:r,stackStartFn:n}=e;let{actual:o,expected:i}=e;const s=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=t)super(String(t));else if(browser_default.stderr&&browser_default.stderr.isTTY&&(browser_default.stderr&&browser_default.stderr.getColorDepth&&1!==browser_default.stderr.getColorDepth()?(blue="[34m",green="[32m",white="[39m",red="[31m"):(blue="",green="",white="",red="")),"object"==typeof o&&null!==o&&"object"==typeof i&&null!==i&&"stack"in o&&o instanceof Error&&"stack"in i&&i instanceof Error&&(o=copyError(o),i=copyError(i)),"deepStrictEqual"===r||"strictEqual"===r)super(createErrDiff(o,i,r));else if("notDeepStrictEqual"===r||"notStrictEqual"===r){let e=kReadableOperator[r];const t=inspectValue(o).split("\\n");if("notStrictEqual"===r&&"object"==typeof o&&null!==o&&(e=kReadableOperator.notStrictEqualObject),t.length>30)for(t[26]=\`\${blue}...\${white}\`;t.length>27;)t.pop();1===t.length?super(\`\${e} \${t[0]}\`):super(\`\${e}\\n\\n\${t.join("\\n")}\\n\`)}else{let e=inspectValue(o),t="";const n=kReadableOperator[r];"notDeepEqual"===r||"notEqual"===r?(e=\`\${kReadableOperator[r]}\\n\\n\${e}\`,e.length>1024&&(e=\`\${e.slice(0,1021)}...\`)):(t=\`\${inspectValue(i)}\`,e.length>512&&(e=\`\${e.slice(0,509)}...\`),t.length>512&&(t=\`\${t.slice(0,509)}...\`),"deepEqual"===r||"equal"===r?e=\`\${n}\\n\\n\${e}\\n\\nshould equal\\n\\n\`:t=\` \${r} \${t}\`),super(\`\${e}\${t}\`)}Error.stackTraceLimit=s,this.generatedMessage=!t,Object.defineProperty(this,"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),this.code="ERR_ASSERTION",this.actual=o,this.expected=i,this.operator=r,Error.captureStackTrace&&Error.captureStackTrace(this,n),this.stack,this.name="AssertionError"}toString(){return\`\${this.name} [\${this.code}]: \${this.message}\`}[inspect.custom](e,t){return inspect(this,{...t,customInspect:!1,depth:0})}},import_text_min9=__toESM(require_text_min(),1),regexFlagsSupported=void 0!==/a/g.flags,arrayFromSet=e=>{const t=[];return e.forEach((e=>t.push(e))),t},arrayFromMap=e=>{const t=[];return e.forEach(((e,r)=>t.push([r,e]))),t};function uncurryThis2(e){return e.call.bind(e)}var hasOwnProperty2=uncurryThis2(Object.prototype.hasOwnProperty),propertyIsEnumerable=uncurryThis2(Object.prototype.propertyIsEnumerable),objectToString2=uncurryThis2(Object.prototype.toString),{isAnyArrayBuffer:isAnyArrayBuffer2,isArrayBufferView:isArrayBufferView2,isDate:isDate2,isMap:isMap2,isRegExp:isRegExp2,isSet:isSet2,isNativeError:isNativeError,isBoxedPrimitive:isBoxedPrimitive2,isNumberObject:isNumberObject2,isStringObject:isStringObject2,isBooleanObject:isBooleanObject2,isBigIntObject:isBigIntObject2,isSymbolObject:isSymbolObject2,isFloat32Array:isFloat32Array2,isFloat64Array:isFloat64Array2}=types;function isNonIndex(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){const r=e.charCodeAt(t);if(r<48||r>57)return!0}return 10===e.length&&e>=2**32}function getOwnNonIndexProperties(e){return Object.keys(e).filter(isNonIndex).concat(Object.getOwnPropertySymbols(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}function compare(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0}var ONLY_ENUMERABLE=void 0,kStrict=!0,kLoose=!1,kNoIterator=0,kIsArray=1,kIsSet=2,kIsMap=3;function areSimilarRegExps(e,t){return regexFlagsSupported?e.source===t.source&&e.flags===t.flags:RegExp.prototype.toString.call(e)===RegExp.prototype.toString.call(t)}function areSimilarFloatArrays(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function areSimilarTypedArrays(e,t){return e.byteLength===t.byteLength&&0===compare(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function areEqualArrayBuffers(e,t){return e.byteLength===t.byteLength&&0===compare(new Uint8Array(e),new Uint8Array(t))}function isEqualBoxedPrimitive(e,t){return isNumberObject2(e)?isNumberObject2(t)&&Object.is(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):isStringObject2(e)?isStringObject2(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):isBooleanObject2(e)?isBooleanObject2(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):isBigIntObject2(e)?isBigIntObject2(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):isSymbolObject2(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}function innerDeepEqual(e,t,r,n){if(e===t)return 0!==e||(!r||Object.is(e,t));if(r){if("object"!=typeof e)return"number"==typeof e&&Number.isNaN(e)&&Number.isNaN(t);if("object"!=typeof t||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!=typeof e)return(null===t||"object"!=typeof t)&&e==t;if(null===t||"object"!=typeof t)return!1}const o=objectToString2(e);if(o!==objectToString2(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;const o=getOwnNonIndexProperties(e,ONLY_ENUMERABLE),i=getOwnNonIndexProperties(t,ONLY_ENUMERABLE);return o.length===i.length&&keyCheck(e,t,r,n,kIsArray,o)}if("[object Object]"===o&&(!isMap2(e)&&isMap2(t)||!isSet2(e)&&isSet2(t)))return!1;if(isDate2(e)){if(!isDate2(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(isRegExp2(e)){if(!isRegExp2(t)||!areSimilarRegExps(e,t))return!1}else if(isNativeError(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(isArrayBufferView2(e)){if(r||!isFloat32Array2(e)&&!isFloat64Array2(e)){if(!areSimilarTypedArrays(e,t))return!1}else if(!areSimilarFloatArrays(e,t))return!1;const o=getOwnNonIndexProperties(e,ONLY_ENUMERABLE),i=getOwnNonIndexProperties(t,ONLY_ENUMERABLE);return o.length===i.length&&keyCheck(e,t,r,n,kNoIterator,o)}if(isSet2(e))return!(!isSet2(t)||e.size!==t.size)&&keyCheck(e,t,r,n,kIsSet);if(isMap2(e))return!(!isMap2(t)||e.size!==t.size)&&keyCheck(e,t,r,n,kIsMap);if(isAnyArrayBuffer2(e)){if(!areEqualArrayBuffers(e,t))return!1}else if(isBoxedPrimitive2(e)&&!isEqualBoxedPrimitive(e,t))return!1}return keyCheck(e,t,r,n,kNoIterator)}function getEnumerables(e,t){return t.filter((t=>propertyIsEnumerable(e,t)))}function keyCheck(e,t,r,n,o,i){if(5===arguments.length){i=Object.keys(e);const r=Object.keys(t);if(i.length!==r.length)return!1}let s=0;for(;s<i.length;s++)if(!hasOwnProperty2(t,i[s]))return!1;if(r&&5===arguments.length){const r=Object.getOwnPropertySymbols(e);if(0!==r.length){let n=0;for(s=0;s<r.length;s++){const o=r[s];if(propertyIsEnumerable(e,o)){if(!propertyIsEnumerable(t,o))return!1;i.push(o),n++}else if(propertyIsEnumerable(t,o))return!1}const o=Object.getOwnPropertySymbols(t);if(r.length!==o.length&&getEnumerables(t,o).length!==n)return!1}else{const e=Object.getOwnPropertySymbols(t);if(0!==e.length&&0!==getEnumerables(t,e).length)return!1}}if(0===i.length&&(o===kNoIterator||o===kIsArray&&0===e.length||0===e.size))return!0;if(void 0===n)n={val1:new Map,val2:new Map,position:0};else{const r=n.val1.get(e);if(void 0!==r){const e=n.val2.get(t);if(void 0!==e)return r===e}n.position++}n.val1.set(e,n.position),n.val2.set(t,n.position);const a=objEquiv(e,t,r,i,n,o);return n.val1.delete(e),n.val2.delete(t),a}function setHasEqualElement(e,t,r,n){const o=arrayFromSet(e);for(let i=0;i<o.length;i++){const s=o[i];if(innerDeepEqual(t,s,r,n))return e.delete(s),!0}return!1}function findLooseMatchingPrimitives(e){switch(typeof e){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(Number.isNaN(e))return!1}return!0}function setMightHaveLoosePrim(e,t,r){const n=findLooseMatchingPrimitives(r);return null!=n?n:t.has(n)&&!e.has(n)}function mapMightHaveLoosePrim(e,t,r,n,o){const i=findLooseMatchingPrimitives(r);if(null!=i)return i;const s=t.get(i);return!(void 0===s&&!t.has(i)||!innerDeepEqual(n,s,!1,o))&&(!e.has(i)&&innerDeepEqual(n,s,!1,o))}function setEquiv(e,t,r,n){let o=null;const i=arrayFromSet(e);for(let n=0;n<i.length;n++){const s=i[n];if("object"==typeof s&&null!==s)null===o&&(o=new Set),o.add(s);else if(!t.has(s)){if(r)return!1;if(!setMightHaveLoosePrim(e,t,s))return!1;null===o&&(o=new Set),o.add(s)}}if(null!==o){const i=arrayFromSet(t);for(let t=0;t<i.length;t++){const s=i[t];if("object"==typeof s&&null!==s){if(!setHasEqualElement(o,s,r,n))return!1}else if(!r&&!e.has(s)&&!setHasEqualElement(o,s,r,n))return!1}return 0===o.size}return!0}function mapHasEqualEntry(e,t,r,n,o,i){const s=arrayFromSet(e);for(let a=0;a<s.length;a++){const c=s[a];if(innerDeepEqual(r,c,o,i)&&innerDeepEqual(n,t.get(c),o,i))return e.delete(c),!0}return!1}function mapEquiv(e,t,r,n){let o=null;const i=arrayFromMap(e);for(let s=0;s<i.length;s++){const[a,c]=i[s];if("object"==typeof a&&null!==a)null===o&&(o=new Set),o.add(a);else{const i=t.get(a);if(void 0===i&&!t.has(a)||!innerDeepEqual(c,i,r,n)){if(r)return!1;if(!mapMightHaveLoosePrim(e,t,a,c,n))return!1;null===o&&(o=new Set),o.add(a)}}}if(null!==o){const i=arrayFromMap(t);for(let t=0;t<i.length;t++){const[s,a]=i[t];if("object"==typeof s&&null!==s){if(!mapHasEqualEntry(o,e,s,a,r,n))return!1}else if(!(r||e.has(s)&&innerDeepEqual(e.get(s),a,!1,n)||mapHasEqualEntry(o,e,s,a,!1,n)))return!1}return 0===o.size}return!0}function objEquiv(e,t,r,n,o,i){let s=0;if(i===kIsSet){if(!setEquiv(e,t,r,o))return!1}else if(i===kIsMap){if(!mapEquiv(e,t,r,o))return!1}else if(i===kIsArray)for(;s<e.length;s++){if(!hasOwnProperty2(e,s)){if(hasOwnProperty2(t,s))return!1;{const n=Object.keys(e);for(;s<n.length;s++){const i=n[s];if(!hasOwnProperty2(t,i)||!innerDeepEqual(e[i],t[i],r,o))return!1}return n.length===Object.keys(t).length}}if(!hasOwnProperty2(t,s)||!innerDeepEqual(e[s],t[s],r,o))return!1}for(s=0;s<n.length;s++){const i=n[s];if(!innerDeepEqual(e[i],t[i],r,o))return!1}return!0}function isDeepEqual(e,t){return innerDeepEqual(e,t,kLoose)}function isDeepStrictEqual(e,t){return innerDeepEqual(e,t,kStrict)}var{ERR_AMBIGUOUS_ARGUMENT:ERR_AMBIGUOUS_ARGUMENT,ERR_INVALID_ARG_TYPE:ERR_INVALID_ARG_TYPE2,ERR_INVALID_ARG_VALUE:ERR_INVALID_ARG_VALUE,ERR_INVALID_RETURN_VALUE:ERR_INVALID_RETURN_VALUE,ERR_MISSING_ARGS:ERR_MISSING_ARGS}=codes,{isPromise:isPromise2,isRegExp:isRegExp3}=types,warned=!1,assert=ok,assert_default=assert,NO_EXCEPTION_SENTINEL={};function innerFail(e){if(e.message instanceof Error)throw e.message;throw new AssertionError(e)}function fail(e,t,r,n,o){const i=arguments.length;let s;if(0===i)s="Failed";else if(1===i)r=e,e=void 0;else{if(!1===warned){warned=!0;(browser_default.emitWarning?browser_default.emitWarning:console.warn.bind(console))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}2===i&&(n="!=")}if(r instanceof Error)throw r;const a={actual:e,expected:t,operator:void 0===n?"fail":n,stackStartFn:o||fail};void 0!==r&&(a.message=r);const c=new AssertionError(a);throw s&&(c.message=s,c.generatedMessage=!0),c}function innerOk(e,t,r,n){if(!r){let o=!1;if(0===t)o=!0,n="No value argument passed to \`assert.ok()\`";else if(n instanceof Error)throw n;const i=new AssertionError({actual:r,expected:!0,message:n,operator:"==",stackStartFn:e});throw i.generatedMessage=o,i}}function ok(...e){innerOk(ok,e.length,...e)}function notDeepStrictEqual(e,t,r){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");isDeepStrictEqual(e,t)&&innerFail({actual:e,expected:t,message:r,operator:"notDeepStrictEqual",stackStartFn:notDeepStrictEqual})}assert.fail=fail,assert.AssertionError=AssertionError,assert.ok=ok,assert.equal=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");t!=r&&innerFail({actual:t,expected:r,message:n,operator:"==",stackStartFn:e})},assert.notEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");t==r&&innerFail({actual:t,expected:r,message:n,operator:"!=",stackStartFn:e})},assert.deepEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");isDeepEqual(t,r)||innerFail({actual:t,expected:r,message:n,operator:"deepEqual",stackStartFn:e})},assert.notDeepEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");isDeepEqual(t,r)&&innerFail({actual:t,expected:r,message:n,operator:"notDeepEqual",stackStartFn:e})},assert.deepStrictEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");isDeepStrictEqual(t,r)||innerFail({actual:t,expected:r,message:n,operator:"deepStrictEqual",stackStartFn:e})},assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");Object.is(t,r)||innerFail({actual:t,expected:r,message:n,operator:"strictEqual",stackStartFn:e})},assert.notStrictEqual=function e(t,r,n){if(arguments.length<2)throw new ERR_MISSING_ARGS("actual","expected");Object.is(t,r)&&innerFail({actual:t,expected:r,message:n,operator:"notStrictEqual",stackStartFn:e})};var Comparison=class{constructor(e,t,r){t.forEach((t=>{t in e&&(void 0!==r&&"string"==typeof r[t]&&isRegExp3(e[t])&&e[t].test(r[t])?this[t]=r[t]:this[t]=e[t])}))}};function compareExceptionKey(e,t,r,n,o,i){if(!(r in e)||!isDeepStrictEqual(e[r],t[r])){if(!n){const r=new Comparison(e,o),n=new Comparison(t,o,e),s=new AssertionError({actual:r,expected:n,operator:"deepStrictEqual",stackStartFn:i});throw s.actual=e,s.expected=t,s.operator=i.name,s}innerFail({actual:e,expected:t,message:n,operator:i.name,stackStartFn:i})}}function expectedException(e,t,r,n){if("function"!=typeof t){if(isRegExp3(t))return t.test(e);if(2===arguments.length)throw new ERR_INVALID_ARG_TYPE2("expected",["Function","RegExp"],t);if("object"!=typeof e||null===e){const o=new AssertionError({actual:e,expected:t,message:r,operator:"deepStrictEqual",stackStartFn:n});throw o.operator=n.name,o}const o=Object.keys(t);if(t instanceof Error)o.push("name","message");else if(0===o.length)throw new ERR_INVALID_ARG_VALUE("error",t,"may not be an empty object");return o.forEach((i=>{"string"==typeof e[i]&&isRegExp3(t[i])&&t[i].test(e[i])||compareExceptionKey(e,t,i,r,o,n)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function getActual(e){if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE2("fn","Function",e);try{e()}catch(e){return e}return NO_EXCEPTION_SENTINEL}function checkIsPromise(e){return isPromise2(e)||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch}function waitForActual(e){return Promise.resolve().then((()=>{let t;if("function"==typeof e){if(t=e(),!checkIsPromise(t))throw new ERR_INVALID_RETURN_VALUE("instance of Promise","promiseFn",t)}else{if(!checkIsPromise(e))throw new ERR_INVALID_ARG_TYPE2("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((()=>t)).then((()=>NO_EXCEPTION_SENTINEL)).catch((e=>e))}))}function expectsError(e,t,r,n){if("string"==typeof r){if(4===arguments.length)throw new ERR_INVALID_ARG_TYPE2("error",["Object","Error","Function","RegExp"],r);if("object"==typeof t&&null!==t){if(t.message===r)throw new ERR_AMBIGUOUS_ARGUMENT("error/message",\`The error message "\${t.message}" is identical to the message.\`)}else if(t===r)throw new ERR_AMBIGUOUS_ARGUMENT("error/message",\`The error "\${t}" is identical to the message.\`);n=r,r=void 0}else if(null!=r&&"object"!=typeof r&&"function"!=typeof r)throw new ERR_INVALID_ARG_TYPE2("error",["Object","Error","Function","RegExp"],r);if(t===NO_EXCEPTION_SENTINEL){let t="";r&&r.name&&(t+=\` (\${r.name})\`),t+=n?\`: \${n}\`:".";const o="rejects"===e.name?"rejection":"exception";innerFail({actual:void 0,expected:r,operator:e.name,message:\`Missing expected \${o}\${t}\`,stackStartFn:e})}if(r&&!expectedException(t,r,n,e))throw t}function expectsNoError(e,t,r,n){if(t!==NO_EXCEPTION_SENTINEL){if("string"==typeof r&&(n=r,r=void 0),!r||expectedException(t,r)){const o=n?\`: \${n}\`:".",i="doesNotReject"===e.name?"rejection":"exception";innerFail({actual:t,expected:r,operator:e.name,message:\`Got unwanted \${i}\${o}\\nActual message: "\${t&&t.message}"\`,stackStartFn:e})}throw t}}function strict(...e){innerOk(strict,e.length,...e)}assert.throws=function e(t,...r){expectsError(e,getActual(t),...r)},assert.rejects=function e(t,...r){return waitForActual(t).then((t=>expectsError(e,t,...r)))},assert.doesNotThrow=function e(t,...r){expectsNoError(e,getActual(t),...r)},assert.doesNotReject=function e(t,...r){return waitForActual(t).then((t=>expectsNoError(e,t,...r)))},assert.ifError=function e(t){if(null!=t){let n="ifError got unwanted exception: ";"object"==typeof t&&"string"==typeof t.message?0===t.message.length&&t.constructor?n+=t.constructor.name:n+=t.message:n+=inspect(t);const o=new AssertionError({actual:t,expected:null,operator:"ifError",message:n,stackStartFn:e}),i=t.stack;if("string"==typeof i){const e=i.split("\\n");e.shift();let t=o.stack.split("\\n");for(var r=0;r<e.length;r++){const n=t.indexOf(e[r]);if(-1!==n){t=t.slice(0,n);break}}o.stack=\`\${t.join("\\n")}\\n\${e.join("\\n")}\`}throw o}},assert.strict=Object.assign(strict,assert,{equal:assert.strictEqual,deepEqual:assert.deepStrictEqual,notEqual:assert.notStrictEqual,notDeepEqual:assert.notDeepStrictEqual}),assert.strict.strict=assert.strict,assert_default(!0,"1 should be equal to 1");
/*! Bundled license information:

@frida/assert/internal/util/comparisons.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
   * @license  MIT
   *)
*/"
`;
